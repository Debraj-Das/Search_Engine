Weak Subsequence                    

httpscodeforcescomproblemsetproblem135E

combinatorics

3000

Little Petya very much likes strings Recently he has received a voucher to purchase a string as a gift from his mother The string can be bought in the local shop One can consider that the shop has all sorts of strings over the alphabet of fixed size The size of the alphabet is equal to k However the voucher has a string type limitation specifically the voucher can be used to purchase string s if the length of strings longest substring that is also its weak subsequence see the definition given below equals wString a with the length of n is considered the weak subsequence of the string s with the length of m if there exists such a set of indexes 1i1i2inm that has the following two properties   aksik for all k from 1 to n  there exists at least one such k 1kn for which ik1ik1 Petya got interested how many different strings are available for him to purchase in the shop As the number of strings can be very large please find it modulo 1000000007 1097 If there are infinitely many such strings print 1
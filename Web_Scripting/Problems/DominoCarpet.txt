Domino Carpet                    

httpscodeforcescomproblemsetproblem77D

dp

2300

Mike the TV greets you again Tired of the monotonous furniture Sick of gray routine Dreaming about dizzying changes in your humble abode We have something to offer you This domino carpet for only 9999 will change your life You can lay it on the floor hang it on the wall or even on the ceiling Among other things  Having watched the commercial virus Hexadecimal also wanted to get a Domino Carpet and wanted badly to be photographed in front of it But of course a virus will never consent to buying a licensed Carpet So she ordered a truck of dominoes and decided to make such a Carpet herself The original Domino Carpet is a field of squares nm in size Each square is half of a domino and can be rotated either vertically or horizontally independently from its neighbors Vertically rotated domino halves look like this    And horizontally rotated halves look like this   Notice that some halves looks the same in both rotations but other halves differDominoes bought by Hexadecimal are represented by uncuttable chips 12 in size which can be laid either vertically or horizontally If the chip is laid vertically then both of its halves should be laid vertically orientated if the chip is laid horizontally then both of its halves should be laid horizontallyThe samples of valid and invalid dominoes laid vertically and horizontally are    Virus Hexadecimal assembles her own Domino Carpet so that the following conditions are satisfied  each carpet square is covered by a domino chip ie there are no empty squares  all domino chips lie entirely within the carpet and dont overlap with each other  if there is a horizontal domino chip with its left half in column j then there are no horizontal domino chips with their left halves in columns j1 or j1 Before starting to assemble her own Domino Carpet the virus wants to know the number of ways to achieve the intended purpose modulo 1097You can assume that the virus has an infinitely large number of dominoes of each type
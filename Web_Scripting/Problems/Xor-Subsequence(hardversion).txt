Xor-Subsequence (hard version)                    

https://codeforces.com/problemset/problem/1720/D2

bitmasks

2400

It is the hard version of the problem. The only difference is that in this version a_i \le 10^9.You are given an array of n integers a_0, a_1, a_2, \ldots a_{n - 1}. Bryap wants to find the longest beautiful subsequence in the array.An array b = [b_0, b_1, \ldots, b_{m-1}], where 0 \le b_0 < b_1 < \ldots < b_{m - 1} < n, is a subsequence of length m of the array a.Subsequence b = [b_0, b_1, \ldots, b_{m-1}] of length m is called beautiful, if the following condition holds:   For any p (0 \le p < m - 1) holds: a_{b_p} \oplus b_{p+1} < a_{b_{p+1}} \oplus b_p. Here a \oplus b denotes the bitwise XOR of a and b. For example, 2 \oplus 4 = 6 and 3 \oplus 1=2.Bryap is a simple person so he only wants to know the length of the longest such subsequence. Help Bryap and find the answer to his question.
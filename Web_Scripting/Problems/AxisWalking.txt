Axis Walking                    

httpscodeforcescomproblemsetproblem327E

bitmasks

2300

Iahub wants to meet his girlfriend Iahubina They both live in Ox axis the horizontal axis Iahub lives at point 0 and Iahubina at point dIahub has n positive integers a1 a2  an The sum of those numbers is d Suppose p1 p2  pn is a permutation of 12n Then let b1ap1 b2ap2 and so on The array b is called a route There are n different routes one for each permutation pIahubs travel schedule is he walks b1 steps on Ox axis then he makes a break in point b1 Then he walks b2 more steps on Ox axis and makes a break in point b1b2 Similarly at jth 1jn time he walks bj more steps on Ox axis and makes a break in point b1b2bjIahub is very superstitious and has k integers which give him bad luck He calls a route good if he never makes a break in a point corresponding to one of those k numbers For his own curiosity answer how many good routes he can make modulo 1000000007 1097 
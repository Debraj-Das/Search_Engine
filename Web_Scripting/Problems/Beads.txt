Beads                    

httpscodeforcescomproblemsetproblem8E

dp

2600

One Martian boy called Zorg wants to present a string of beads to his friend from the Earth  Masha He knows that Masha likes two colours blue and red  and right in the shop where he has come there is a variety of adornments with beads of these two colours All the strings of beads have a small fastener and if one unfastens it one might notice that all the strings of beads in the shop are of the same length Because of the peculiarities of the Martian eyesight if Zorg sees one blueandred string of beads first and then the other with red beads instead of blue ones and blue  instead of red he regards these two strings of beads as identical In other words Zorg regards as identical not only those strings of beads that can be derived from each other by the string turnover but as well those that can be derived from each other by a mutual replacement of colours andor by the string turnoverIt is known that all Martians are very orderly and if a Martian sees some amount of objects he tries to put them in good order Zorg thinks that a red bead is smaller than a blue one Lets put 0 for a red bead and 1  for a blue one From two strings the Martian puts earlier the string with a red bead in the ith position providing that the second string has a blue bead in the ith position and the first two beads i1 are identicalAt first Zorg unfastens all the strings of beads and puts them into small heaps so that in each heap strings are identical in his opinion Then he sorts out the heaps and chooses the minimum string in each heap in his opinion He gives the unnecassary strings back to the shop assistant and says he doesnt need them any more Then Zorg sorts out the remaining strings of beads and buys the string with index k All these manupulations will take Zorg a lot of time thats why he asks you to help and find the string of beads for Masha
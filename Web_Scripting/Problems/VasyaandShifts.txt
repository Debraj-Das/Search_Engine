Vasya and Shifts                    

httpscodeforcescomproblemsetproblem832E

matrices

2600

Vasya has a set of 4n strings of equal length consisting of lowercase English letters a b c d and e Moreover the set is split into n groups of 4 equal strings each Vasya also has one special string a of the same length consisting of letters a onlyVasya wants to obtain from string a some fixed string b in order to do this he can use the strings from his set in any order When he uses some string x each of the letters in string a replaces with the next letter in alphabet as many times as the alphabet position counting from zero of the corresponding letter in string x Within this process the next letter in alphabet after e is aFor example if some letter in a equals b and the letter on the same position in x equals c then the letter in a becomes equal d because c is the second alphabet letter counting from zero If some letter in a equals e and on the same position in x is d then the letter in a becomes c For example if the string a equals abcde and string x equals baddc then a becomes bbabbA used string disappears but Vasya can use equal strings several timesVasya wants to know for q given strings b how many ways there are to obtain from the string a string b using the given set of 4n strings Two ways are different if the number of strings used from some group of 4 strings is different Help Vasya compute the answers for these questions modulo 1097
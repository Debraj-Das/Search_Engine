Anya and Smartphone                    

httpscodeforcescomproblemsetproblem518C

constructive algorithms

1600

Anya has bought a new smartphone that uses Berdroid operating system The smartphone menu has exactly n applications each application has its own icon The icons are located on different screens one screen contains k icons The icons from the first to the kth one are located on the first screen from the k1th to the 2kth ones are on the second screen and so on the last screen may be partially emptyInitially the smartphone menu is showing the screen number 1 To launch the application with the icon located on the screen t Anya needs to make the following gestures first she scrolls to the required screen number t by making t1 gestures if the icon is on the screen t and then make another gesture  press the icon of the required application exactly once to launch itAfter the application is launched the menu returns to the first screen That is to launch the next application you need to scroll through the menu again starting from the screen number 1All applications are numbered from 1 to n We know a certain order in which the icons of the applications are located in the menu at the beginning but it changes as long as you use the operating system Berdroid is intelligent system so it changes the order of the icons by moving the more frequently used icons to the beginning of the list Formally right after an application is launched Berdroid swaps the application icon and the icon of a preceding application that is the icon of an application on the position that is smaller by one in the order of menu The preceding icon may possibly be located on the adjacent screen The only exception is when the icon of the launched application already occupies the first place in this case the icon arrangement doesnt changeAnya has planned the order in which she will launch applications How many gestures should Anya make to launch the applications in the planned order Note that one application may be launched multiple times
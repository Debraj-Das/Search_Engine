Cowslip Collections                    

httpscodeforcescomproblemsetproblem645F

combinatorics

2500

In an attempt to make peace with the Mischievious Mess Makers Bessie and Farmer John are planning to plant some flower gardens to complement the lush grassy fields of Bovinia As any good horticulturist knows each garden they plant must have the exact same arrangement of flowers Initially Farmer John has n different species of flowers he can plant with ai flowers of the ith speciesOn each of the next q days Farmer John will receive a batch of flowers of a new species On day j he will receive cj flowers of the same species but of a different species from those Farmer John already has Farmer John knowing the right balance between extravagance and minimalism wants exactly k species of flowers to be used Furthermore to reduce waste each flower of the k species Farmer John chooses must be planted in some garden And each of the gardens must be identical that is to say that each of the k chosen species should have an equal number of flowers in each garden As Farmer John is a proponent of national equality he would like to create the greatest number of gardens possibleAfter receiving flowers on each of these q days Farmer John would like to know the sum over all possible choices of k species of the maximum number of gardens he could create Since this could be a large number you should output your result modulo 1097
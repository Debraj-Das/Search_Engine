Archaeology                    

httpscodeforcescomproblemsetproblem176E

data structures

3100

This time you should help a team of researchers on an island in the Pacific Ocean They research the culture of the ancient tribes that used to inhabit the island many years agoOverall theyve dug out n villages Some pairs of villages were connected by roads People could go on the roads in both directions Overall there were exactly n1 roads and from any village one could get to any other oneThe tribes were not peaceful and they had many wars As a result of the wars some villages were destroyed completely During more peaceful years some of the villages were restoredAt each moment of time people used only those roads that belonged to some shortest way between two villages that existed at the given moment In other words people used the minimum subset of roads in such a way that it was possible to get from any existing village to any other existing one Note that throughout the islands whole history there existed exactly n1 roads that have been found by the researchers There never were any other roadsThe researchers think that observing the total sum of used roads lengths at different moments of time can help to better understand the tribes culture and answer several historical questionsYou will be given the full history of the tribes existence Your task is to determine the total length of used roads at some moments of time
Cycle                    

httpscodeforcescomproblemsetproblem135D

brute force

2500

Little Petya very much likes rectangular tables that consist of characters 0 and 1 Recently he has received one such table as a gift from his mother The table contained n rows and m columns The rows are numbered from top to bottom from 1 to n the columns are numbered from the left to the right from 1 to m Petya immediately decided to find the longest cool cycle whatever it takesA cycle is a sequence of pairwise distinct cells where each two consecutive cells have a common side besides the first cell has a common side with the last cell A cycle is called cool if it fulfills all the following conditions simultaneously   The cycle entirely consists of the cells that contain 1  Each cell that belongs to the cycle has a common side with exactly two other cells that belong to the cycle  Each cell of the table that contains 1 either belongs to the cycle or is positioned outside of it see definition below To define the notion of outside formally lets draw a cycle on a plane Let each cell of the cycle ij i is the row number j is the column number correspond to the point ij on the coordinate plane Let a straight line segment join each pair of points that correspond to the cells belonging to the cycle and sharing a side Thus we will get a closed polyline that has no selfintersections and selftouches The polyline divides the plane into two connected parts the part of an infinite area and the part of a finite area It is considered that cell rc lies outside of the cycle if it does not belong to the cycle and the corresponding point on the plane with coordinates rc lies in the part with the infinite areaHelp Petya to find the length of the longest cool cycle in the table The cycle length is defined as the number of cells that belong to the cycle
Sereja and Tree                    

httpscodeforcescomproblemsetproblem380B

graphs

2400

Sereja adores trees Today he came up with a revolutionary new type of binary root treesHis new tree consists of n levels each vertex is indexed by two integers the number of the level and the number of the vertex on the current level The tree root is at level 1 its index is 11 Here is a pseudo code of tree constructionthe global data are integer arrays cnt left rightcnt1  1fill arrays left right with values 1forlevel  1 level  n level  level  1    cntlevel  1  0    forposition  1 position  cntlevel position  position  1        ifthe value of position is a power of two  that is 1 2 4 8            leftlevelposition  cntlevel  1  1            rightlevelposition  cntlevel  1  2            cntlevel  1  cntlevel  1  2                    else            rightlevelposition  cntlevel  1  1            cntlevel  1  cntlevel  1  1            After the pseudo code is run cell cntlevel contains the number of vertices on level level Cell leftlevelposition contains the number of the vertex on the level level1 which is the left child of the vertex with index levelposition or it contains 1 if the vertex doesnt have a left child Similarly cell rightlevelposition is responsible for the right child You can see how the tree with n4 looks like in the notesSerja loves to make things complicated so he first made a tree and then added an empty set Alevelposition for each vertex Then Sereja executes m operations Each operation is of one of the two following types  The format of the operation is 1 t l r x For all vertices levelposition leveltlpositionr add value x to set Alevelposition  The format of the operation is 2 t v For vertex levelposition leveltpositionv find the union of all sets of vertices that are in the subtree of vertex levelposition Print the size of the union of these sets Help Sereja execute the operations In this problem a set contains only distinct values like stdset in C
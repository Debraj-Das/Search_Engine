Coin Troubles                    

httpscodeforcescomproblemsetproblem283C

dp

2100

In the Isle of Guernsey there are n different types of coins For each i 1in coin of type i is worth ai cents It is possible that aiaj for some i and j ij Bessie has some set of these coins totaling t cents She tells Jessie q pairs of integers For each i 1iq the pair bici tells Jessie that Bessie has a strictly greater number of coins of type bi than coins of type ci It is known that all bi are distinct and all ci are distinct Help Jessie find the number of possible combinations of coins Bessie could have Two combinations are considered different if there is some i 1in such that the number of coins Bessie has of type i is different in the two combinations Since the answer can be very large output it modulo 1000000007 1097 If there are no possible combinations of coins totaling t cents that satisfy Bessies conditions output 0
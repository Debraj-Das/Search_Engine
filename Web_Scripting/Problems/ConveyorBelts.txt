Conveyor Belts                    

httpscodeforcescomproblemsetproblem487D

data structures

2700

Automatic Bakery of Cyberland ABC recently bought an nm rectangle table To serve the diners ABC placed seats around the table The size of each seat is equal to a unit square so there are 2nm seats in totalABC placed conveyor belts on each unit square on the table There are three types of conveyor belts   and  A  belt can bring things upwards  can bring leftwards and  can bring rightwardsLets number the rows with 1 to n from top to bottom the columns with 1 to m from left to right We consider the seats above and below the top of the table are rows 0 and n1 respectively Also we define seats to the left of the table and to the right of the table to be column 0 and m1 Due to the conveyor belts direction restriction there are currently no way for a diner sitting in the row n1 to be servedGiven the initial table there will be q events in order There are two types of events  A x y means a piece of bread will appear at row x and column y we will denote such position as xy The bread will follow the conveyor belt until arriving at a seat of a diner It is possible that the bread gets stuck in an infinite loop Your task is to simulate the process and output the final position of the bread or determine that there will be an infinite loop  C x y c means that the type of the conveyor belt at xy is changed to c Queries are performed separately meaning that even if the bread got stuck in an infinite loop it wont affect further queries
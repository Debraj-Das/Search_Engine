Counting Skyscrapers                    

httpscodeforcescomproblemsetproblem335E

dp

2800

A number of skyscrapers have been built in a line The number of skyscrapers was chosen uniformly at random between 2 and 314 314 factorial a very large number The height of each skyscraper was chosen randomly and independently with height i having probability 2i for all positive integers i The floors of a skyscraper with height i are numbered 0 through i1To speed up transit times a number of zip lines were installed between skyscrapers Specifically there is a zip line connecting the ith floor of one skyscraper with the ith floor of another skyscraper if and only if there are no skyscrapers between them that have an ith floorAlice and Bob decide to count the number of skyscrapersAlice is thorough and wants to know exactly how many skyscrapers there are She begins at the leftmost skyscraper with a counter at 1 She then moves to the right one skyscraper at a time adding 1 to her counter each time she moves She continues until she reaches the rightmost skyscraperBob is impatient and wants to finish as fast as possible He begins at the leftmost skyscraper with a counter at 1 He moves from building to building using zip lines At each stage Bob uses the highest available zip line to the right but ignores floors with a height greater than h due to fear of heights When Bob uses a zip line he travels too fast to count how many skyscrapers he passed Instead he just adds 2i to his counter where i is the number of the floor hes currently on He continues until he reaches the rightmost skyscraperConsider the following example There are 6 buildings with heights 1 4 3 4 1 2 from left to right and h2 Alice begins with her counter at 1 and then adds 1 five times for a result of 6 Bob begins with his counter at 1 then he adds 1 4 4 and 2 in order for a result of 12 Note that Bob ignores the highest zip line because of his fear of heights h2  Bobs counter is at the top of the image and Alices counter at the bottom All zip lines are shown Bobs path is shown by the green dashed line and Alices by the pink dashed line The floors of the skyscrapers are numbered and the zip lines Bob uses are marked with the amount he adds to his counterWhen Alice and Bob reach the rightmost skyscraper they compare counters You will be given either the value of Alices counter or the value of Bobs counter and must compute the expected value of the others counter
Playing with String                    

httpscodeforcescomproblemsetproblem305E

games

2300

Two people play the following string game Initially the players have got some string s The players move in turns the player who cannot make a move loses Before the game began the string is written on a piece of paper one letter per cell  An example of the initial situation at s  abacaba A players move is the sequence of actions  The player chooses one of the available pieces of paper with some string written on it Lets denote it is t Note that initially only one piece of paper is available  The player chooses in the string tt1t2 tt character in position i 1it such that for some positive integer l 0ililt the following equations hold ti1ti1 ti2ti2  tiltil  Player cuts the cell with the chosen character As a result of the operation he gets three new pieces of paper the first one will contain string t1t2 ti1 the second one will contain a string consisting of a single character ti the third one contains string ti1ti2 tt   An example of making action i4 with string s  abacaba Your task is to determine the winner provided that both players play optimally well If the first player wins find the position of character that is optimal to cut in his first move If there are multiple positions print the minimal possible one
Cycles in product                    

https://codeforces.com/problemset/problem/997/D

combinatorics

2900

Consider a tree (that is, an undirected connected graph without loops) T_1 and a tree T_2. Let's define their cartesian product T_1 \times T_2 in a following way.Let V be the set of vertices in T_1 and U be the set of vertices in T_2.Then the set of vertices of graph T_1 \times T_2 is V \times U, that is, a set of ordered pairs of vertices, where the first vertex in pair is from V and the second — from U.Let's draw the following edges: Between (v, u_1) and (v, u_2) there is an undirected edge, if u_1 and u_2 are adjacent in U.  Similarly, between (v_1, u) and (v_2, u) there is an undirected edge, if v_1 and v_2 are adjacent in V. Please see the notes section for the pictures of products of trees in the sample tests.Let's examine the graph T_1 \times T_2. How much cycles (not necessarily simple) of length k it contains? Since this number can be very large, print it modulo 998244353.The sequence of vertices w_1, w_2, ..., w_k, where w_i \in V \times U called cycle, if any neighboring vertices are adjacent and w_1 is adjacent to w_k. Cycles that differ only by the cyclic shift or direction of traversal are still considered different.
String Theory                    

httpscodeforcescomproblemsetproblem269E

geometry

3100

Emuskald is an innovative musician and always tries to push the boundaries of music production Now he has come up with an idea for a revolutionary musical instrument  a rectangular harpA rectangular harp is a rectangle nm consisting of n rows and m columns The rows are numbered 1 to n from top to bottom Similarly the columns are numbered 1 to m from left to right String pins are spaced evenly across every side one per unit Thus there are n pins on the left and right sides of the harp and m pins on its top and bottom The harp has exactly nm different strings each string connecting two different pins each on a different side of the harpEmuskald has ordered his apprentice to construct the first ever rectangular harp However he didnt mention that no two strings can cross otherwise it would be impossible to play the harp Two strings cross if the segments connecting their pins intersect To fix the harp Emuskald can perform operations of two types   pick two different columns and swap their pins on each side of the harp not changing the pins that connect each string  pick two different rows and swap their pins on each side of the harp not changing the pins that connect each string In the following example he can fix the harp by swapping two columns   Help Emuskald complete his creation and find the permutations how the rows and columns of the harp need to be rearranged or tell that it is impossible to do so He can detach and reattach each string to its pins so the physical layout of the strings doesnt matter
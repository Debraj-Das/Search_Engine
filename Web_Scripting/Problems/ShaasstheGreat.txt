Shaass the Great                    

httpscodeforcescomproblemsetproblem294E

dp

2300

The great Shaass is the new king of the Drakht empire The empire has n cities which are connected by n1 bidirectional roads Each road has an specific length and connects a pair of cities Theres a unique simple path connecting each pair of citiesHis majesty the great Shaass has decided to tear down one of the roads and build another road with the same length between some pair of cities He should build such road that its still possible to travel from each city to any other city He might build the same road againYou as his advisor should help him to find a way to make the described action You should find the way that minimize the total sum of pairwise distances between cities after the action So calculate the minimum sum
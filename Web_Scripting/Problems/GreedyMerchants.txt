Greedy Merchants                    

httpscodeforcescomproblemsetproblem178B3



1800

In ABBYY a wonderful Smart Beaver lives This time he began to study history When he read about the Roman Empire he became interested in the life of merchantsThe Roman Empire consisted of n cities numbered from 1 to n It also had m bidirectional roads numbered from 1 to m Each road connected two different cities Any two cities were connected by no more than one roadWe say that there is a path between cities c1 and c2 if there exists a finite sequence of cities t1t2tp p1 such that  t1c1  tpc2  for any i 1ip cities ti and ti1 are connected by a road We know that there existed a path between any two cities in the Roman EmpireIn the Empire k merchants lived numbered from 1 to k For each merchant we know a pair of numbers si and li where si is the number of the city where this merchants warehouse is and li is the number of the city where his shop is The shop and the warehouse could be located in different cities so the merchants had to deliver goods from the warehouse to the shopLets call a road important for the merchant if its destruction threatens to ruin the merchant that is without this road there is no path from the merchants warehouse to his shop Merchants in the Roman Empire are very greedy so each merchant pays a tax 1 dinar only for those roads which are important for him In other words each merchant pays di dinars of tax where di di0 is the number of roads important for the ith merchantThe tax collection day came in the Empire The Smart Beaver from ABBYY is very curious by nature so he decided to count how many dinars each merchant had paid that day And now he needs your help
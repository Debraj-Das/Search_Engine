Bribes                    

httpscodeforcescomproblemsetproblem575B

dfs and similar

2200

Ruritania is a country with a very badly maintained road network which is not exactly good news for lorry drivers that constantly have to do deliveries In fact when roads are maintained they become oneway It turns out that it is sometimes impossible to get from one town to another in a legal way  however we know that all towns are reachable though illegallyFortunately for us the police tend to be very corrupt and they will allow a lorry driver to break the rules and drive in the wrong direction provided they receive a small gift There is one patrol car for every road and they will request 1000 Ruritanian dinars when a driver drives in the wrong direction However being greedy every time a patrol car notices the same driver breaking the rule they will charge double the amount of money they requested the previous time on that particular roadBorna is a lorry driver that managed to figure out this bribing pattern As part of his job he has to make K stops in some towns all over Ruritania and he has to make these stops in a certain order There are N towns enumerated from 1 to N in Ruritania and Bornas initial location is the capital city ie town 1 He happens to know which ones out of the N1 roads in Ruritania are currently unidirectional but he is unable to compute the least amount of money he needs to prepare for bribing the police Help Borna by providing him with an answer and you will be richly rewarded
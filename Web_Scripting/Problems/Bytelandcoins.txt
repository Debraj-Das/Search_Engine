Byteland coins                    

httpscodeforcescomproblemsetproblem756E

combinatorics

3200

There are n types of coins in Byteland Conveniently the denomination of the coin type k divides the denomination of the coin type k1 the denomination of the coin type 1 equals 1 tugrick The ratio of the denominations of coin types k1 and k equals ak It is known that for each x there are at most 20 coin types of denomination xByteasar has bk coins of type k with him and he needs to pay exactly m tugricks It is known that Byteasar never has more than 3105 coins with him Byteasar want to know how many ways there are to pay exactly m tugricks Two ways are different if there is an integer k such that the amount of coins of type k differs in these two ways As all Byteland citizens Byteasar wants to know the number of ways modulo 1097
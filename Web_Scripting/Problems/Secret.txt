Secret                    

httpscodeforcescomproblemsetproblem271C

constructive algorithms

1500

The Greatest Secret Ever consists of n words indexed by positive integers from 1 to n The secret needs dividing between k Keepers lets index them by positive integers from 1 to k the ith Keeper gets a nonempty set of words with numbers from the set Uiui1ui2uiUi Here and below well presuppose that the set elements are written in the increasing orderWell say that the secret is safe if the following conditions are hold  for any two indexes ij 1ijk the intersection of sets Ui and Uj is an empty set  the union of sets U1U2Uk is set 12n  in each set Ui its elements ui1ui2uiUi do not form an arithmetic progression in particular Ui3 should hold Let us remind you that the elements of set u1u2us form an arithmetic progression if there is such number d that for all i 1is fulfills uidui1 For example the elements of sets 5 110 and 159 form arithmetic progressions and the elements of sets 124 and 368 dontYour task is to find any partition of the set of words into subsets U1U2Uk so that the secret is safe Otherwise indicate that theres no such partition
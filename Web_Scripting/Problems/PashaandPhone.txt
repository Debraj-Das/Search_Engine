Pasha and Phone                    

httpscodeforcescomproblemsetproblem595B

binary search

1600

Pasha has recently bought a new phone jPager and started adding his friends phone numbers there Each phone number consists of exactly n digitsAlso Pasha has a number k and two sequences of length nk n is divisible by k a1a2ank and b1b2bnk Lets split the phone number into blocks of length k The first block will be formed by digits from the phone number that are on positions 1 2 k the second block will be formed by digits from the phone number that are on positions k1 k2  2k and so on Pasha considers a phone number good if the ith block doesnt start from the digit bi and is divisible by ai if represented as an integer To represent the block of length k as an integer lets write it out as a sequence c1 c2ck Then the integer is calculated as the result of the expression c110k1c210k2ckPasha asks you to calculate the number of good phone numbers of length n for the given k ai and bi As this number can be too big print it modulo 1097 
Mahmoud and a Message                    

httpscodeforcescomproblemsetproblem766C

brute force

1700

Mahmoud wrote a message s of length n He wants to send it as a birthday present to his friend Moaz who likes strings He wrote it on a magical paper but he was surprised because some characters disappeared while writing the string Thats because this magical paper doesnt allow character number i in the English alphabet to be written on it in a string of length more than ai For example if a12 he cant write character a on this paper in a string of length 3 or more String aa is allowed while string aaa is notMahmoud decided to split the message into some nonempty substrings so that he can write every substring on an independent magical paper and fulfill the condition The sum of their lengths should be n and they shouldnt overlap For example if a12 and he wants to send string aaa he can split it into a and aa and use 2 magical papers or into a a and a and use 3 magical papers He cant split it into aa and aa because the sum of their lengths is greater than n He can split the message into single string if it fulfills the conditionsA substring of string s is a string that consists of some consecutive characters from string s strings ab abc and b are substrings of string abc while strings acb and ac are not Any string is a substring of itselfWhile Mahmoud was thinking of how to split the message Ehab told him that there are many ways to split it After that Mahmoud asked you three questions   How many ways are there to split the string into substrings such that every substring fulfills the condition of the magical paper the sum of their lengths is n and they dont overlap Compute the answer modulo 1097  What is the maximum length of a substring that can appear in some valid splitting  What is the minimum number of substrings the message can be spit in Two ways are considered different if the sets of split positions differ For example splitting aaa and aaa are considered different splittings of message aaa
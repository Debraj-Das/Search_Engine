Tree Master                    

https://codeforces.com/problemset/problem/1806/E

brute force

2200

You are given a tree with n weighted vertices labeled from 1 to n rooted at vertex 1. The parent of vertex i is p_i and the weight of vertex i is a_i. For convenience, define p_1=0.For two vertices x and y of the same depth^\dagger, define f(x,y) as follows:   Initialize \mathrm{ans}=0.  While both x and y are not 0:   \mathrm{ans}\leftarrow \mathrm{ans}+a_x\cdot a_y;  x\leftarrow p_x;  y\leftarrow p_y.   f(x,y) is the value of \mathrm{ans}. You will process q queries. In the i-th query, you are given two integers x_i and y_i and you need to calculate f(x_i,y_i).^\dagger The depth of vertex v is the number of edges on the unique simple path from the root of the tree to vertex v. 
Xor on Figures                    

https://codeforces.com/problemset/problem/1270/I

constructive algorithms

3500

There is given an integer k and a grid 2^k \times 2^k with some numbers written in its cells, cell (i, j) initially contains number a_{ij}. Grid is considered to be a torus, that is, the cell to the right of (i, 2^k) is (i, 1), the cell below the (2^k, i) is (1, i) There is also given a lattice figure F, consisting of t cells, where t is odd. F doesn't have to be connected.We can perform the following operation: place F at some position on the grid. (Only translations are allowed, rotations and reflections are prohibited). Now choose any nonnegative integer p. After that, for each cell (i, j), covered by F, replace a_{ij} by a_{ij}\oplus p, where \oplus denotes the bitwise XOR operation.More formally, let F be given by cells (x_1, y_1), (x_2, y_2), \dots, (x_t, y_t). Then you can do the following operation: choose any x, y with 1\le x, y \le 2^k, any nonnegative integer p, and for every i from 1 to n replace number in the cell (((x + x_i - 1)\bmod 2^k) + 1, ((y + y_i - 1)\bmod 2^k) + 1) with a_{((x + x_i - 1)\bmod 2^k) + 1, ((y + y_i - 1)\bmod 2^k) + 1}\oplus p.Our goal is to make all the numbers equal to 0. Can we achieve it? If we can, find the smallest number of operations in which it is possible to do this.
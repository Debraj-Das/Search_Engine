Hyperdrive                    

httpscodeforcescomproblemsetproblem44D

math

1800

In a far away galaxy there are n inhabited planets numbered with numbers from 1 to n They are located at large distances from each other thats why the communication between them was very difficult until on the planet number 1 a hyperdrive was invented As soon as this significant event took place n1 spaceships were built on the planet number 1 and those ships were sent to other planets to inform about the revolutionary invention Paradoxical thought it may be but the hyperspace is represented as simple threedimensional Euclidean space The inhabited planets may be considered fixed points in it and no two points coincide and no three points lie on the same straight line The movement of a ship with a hyperdrive between two planets is performed along a straight line at the constant speed the same for all the ships Thats why the distance in the hyperspace are measured in hyperyears a ship with a hyperdrive covers a distance of s hyperyears in s yearsWhen the ship reaches an inhabited planet the inhabitants of the planet dissemble it make n2 identical to it ships with a hyperdrive and send them to other n2 planets except for the one from which the ship arrived The time to make a new ship compared to the time in which they move from one planet to another is so small that it can be disregarded New ships are absolutely identical to the ones sent initially they move at the same constant speed along a straight line trajectory and having reached a planet perform the very same mission ie are dissembled to build new n2 ships and send them to all the planets except for the one from which the ship arrived Thus the process of spreading the important news around the galaxy continuesHowever the hyperdrive creators hurried to spread the news about their invention so much that they didnt study completely what goes on when two ships collide in the hyperspace If two moving ships find themselves at one point they provoke an explosion of colossal power leading to the destruction of the galaxyYour task is to find the time the galaxy will continue to exist from the moment of the ships launch from the first planet
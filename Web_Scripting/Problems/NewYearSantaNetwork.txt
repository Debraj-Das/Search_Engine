New Year Santa Network                    

httpscodeforcescomproblemsetproblem500D

combinatorics

1900

New Year is coming in Tree World In this world as the name implies there are n cities connected by n1 roads and for any two distinct cities there always exists a path between them The cities are numbered by integers from 1 to n and the roads are numbered by integers from 1 to n1 Lets define duv as total length of roads on the path between city u and city vAs an annual event people in Tree World repairs exactly one road per year As a result the length of one road decreases It is already known that in the ith year the length of the rith road is going to become wi which is shorter than its length before Assume that the current year is year 1Three Santas are planning to give presents annually to all the children in Tree World In order to do that they need some preparation so they are going to choose three distinct cities c1 c2 c3 and make exactly one warehouse in each city The kth 1k3 Santa will take charge of the warehouse in city ckIt is really boring for the three Santas to keep a warehouse alone So they decided to build an onlyforSanta network The cost needed to build this network equals to dc1c2dc2c3dc3c1 dollars Santas are too busy to find the best place so they decided to choose c1c2c3 randomly uniformly over all triples of distinct numbers from 1 to n Santas would like to know the expected value of the cost needed to build the networkHowever as mentioned each year the length of exactly one road decreases So the Santas want to calculate the expected after each length change Help them to calculate the value
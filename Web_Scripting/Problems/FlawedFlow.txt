Flawed Flow                    

httpscodeforcescomproblemsetproblem269C

constructive algorithms

2100

Emuskald considers himself a master of flow algorithms Now he has completed his most ingenious program yet  it calculates the maximum flow in an undirected graph The graph consists of n vertices and m edges Vertices are numbered from 1 to n Vertices 1 and n being the source and the sink respectivelyHowever his maxflow algorithm seems to have a little flaw  it only finds the flow volume for each edge but not its direction Help him find for each edge the direction of the flow through this edges Note that the resulting flow should be correct maximum flowMore formally You are given an undirected graph For each its undirected edge ai bi you are given the flow volume ci You should direct all edges in such way that the following conditions hold  for each vertex v 1vn sum of ci of incoming edges is equal to the sum of ci of outcoming edges  vertex with number 1 has no incoming edges  the obtained directed graph does not have cycles 
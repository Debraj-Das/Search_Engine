Berland Traffic                    

httpscodeforcescomproblemsetproblem267C

math

2700

Berland traffic is very different from traffic in other countries The capital of Berland consists of n junctions and m roads Each road connects a pair of junctions There can be multiple roads between a pair of junctions For each road we know its capacity value ci is the maximum number of cars that can drive along a road in any direction per a unit of time For each road the cars can drive along it in one of two direction That it the cars cant simultaneously move in both directions A roads traffic is the number of cars that goes along it per a unit of time For road aibi this value is negative if the traffic moves from bi to ai A roads traffic can be a noninteger numberThe capital has two special junctions  the entrance to the city junction 1 and the exit from the city junction n For all other junctions it is true that the traffic is not lost there That is for all junctions except for 1 and n the incoming traffic sum equals the outgoing traffic sumTraffic has an unusual peculiarity in the capital of Berland  for any pair of junctions xy the sum of traffics along any path from x to y doesnt change depending on the choice of the path Such sum includes traffic along all roads on the path possible with the minus sign if the traffic along the road is directed against the direction of the road on the path from x to yYour task is to find the largest traffic that can pass trough the city per one unit of time as well as the corresponding traffic for each road 
Weird Chess                    

httpscodeforcescomproblemsetproblem538D

brute force

1800

Igor has been into chess for a long time and now he is sick of the game by the ordinary rules He is going to think of new rules of the game and become world famousIgors chessboard is a square of size nn cells Igor decided that simple rules guarantee success thats why his game will have only one type of pieces Besides all pieces in his game are of the same color The possible moves of a piece are described by a set of shift vectors The next passage contains a formal description of available movesLet the rows of the board be numbered from top to bottom and the columns be numbered from left to right from 1 to n Lets assign to each square a pair of integers xy the number of the corresponding column and row Each of the possible moves of the piece is defined by a pair of integers dxdy using this move the piece moves from the field xy to the field xdxydy You can perform the move if the cell xdxydy is within the boundaries of the board and doesnt contain another piece Pieces that stand on the cells other than xy and xdxydy are not important when considering the possibility of making the given move for example like when a knight moves in usual chessIgor offers you to find out what moves his chess piece can make He placed several pieces on the board and for each unoccupied square he told you whether it is attacked by any present piece ie whether some of the pieces on the field can move to that cell Restore a possible set of shift vectors of the piece or else determine that Igor has made a mistake and such situation is impossible for any set of shift vectors
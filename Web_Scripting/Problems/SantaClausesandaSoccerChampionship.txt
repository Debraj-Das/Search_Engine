Santa Clauses and a Soccer Championship                    

httpscodeforcescomproblemsetproblem748F

constructive algorithms

2300

The country Treeland consists of n cities connected with n1 bidirectional roads in such a way that its possible to reach every city starting from any other city using these roads There will be a soccer championship next year and all participants are Santa Clauses There are exactly 2k teams from 2k different citiesDuring the first stage all teams are divided into k pairs Teams of each pair play two games against each other one in the hometown of the first team and the other in the hometown of the other team Thus each of the 2k cities holds exactly one soccer game However its not decided yet how to divide teams into pairsIts also necessary to choose several cities to settle players in Organizers tend to use as few cities as possible to settle the teamsNobody wants to travel too much during the championship so if a team plays in cities u and v it wants to live in one of the cities on the shortest path between u and v maybe in u or in v There is another constraint also the teams from one pair must live in the same citySummarizing the organizers want to divide 2k teams into pairs and settle them in the minimum possible number of cities m in such a way that teams from each pair live in the same city which lies between their hometowns
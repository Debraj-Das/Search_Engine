LCM Sum (hard version)                    

https://codeforces.com/problemset/problem/1712/E2

brute force

2500

We are sum for we are manySome NumberThis version of the problem differs from the previous one only in the constraint on t. You can make hacks only if both versions of the problem are solved.You are given two positive integers l and r.Count the number of distinct triplets of integers (i, j, k) such that l \le i < j < k \le r and \operatorname{lcm}(i,j,k) \ge i + j + k.Here \operatorname{lcm}(i, j, k) denotes the least common multiple (LCM) of integers i, j, and k.
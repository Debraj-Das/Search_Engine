Black Widow                    

httpscodeforcescomproblemsetproblem704C

dp

2900

Natalia Romanova is trying to test something on the new gun SHIELD gave her In order to determine the result of the test she needs to find the number of answers to a certain equation The equation is of formWhere  represents logical OR and  represents logical exclusive OR XOR and vij are some boolean variables or their negations Natalia calls the left side of the equation a XNF formula Each statement in brackets is called a clause and vij are called literalsIn the equation Natalia has the left side is actually a 2XNF2 containing variables x1x2xm and their negations An XNF formula is 2XNF2 if  For each 1in ki2 ie the size of each clause doesnt exceed two  Each variable occurs in the formula at most two times with negation and without negation in total Please note that its possible that a variable occurs twice but its negation doesnt occur in any clause or vice versa Natalia is given a formula of m variables consisting of n clauses Please make sure to check the samples in order to properly understand how the formula looks likeNatalia is more into fight than theory so she asked you to tell her the number of answers to this equation More precisely you need to find the number of ways to set x1xm with true and false out of total of 2m ways so that the equation is satisfied Since this number can be extremely large you need to print the answer modulo 1097Please note that some variable may appear twice in one clause or not appear in the equation at all but still setting it to false or true gives different ways to set variables
Vicky's Delivery Service                    

https://codeforces.com/problemset/problem/1166/F

data structures

2400

In a magical land there are n cities conveniently numbered 1, 2, \dots, n. Some pairs of these cities are connected by magical colored roads. Magic is unstable, so at any time, new roads may appear between two cities.Vicky the witch has been tasked with performing deliveries between some pairs of cities. However, Vicky is a beginner, so she can only complete a delivery if she can move from her starting city to her destination city through a double rainbow. A double rainbow is a sequence of cities c_1, c_2, \dots, c_k satisfying the following properties:  For each i with 1 \le i \le k - 1, the cities c_i and c_{i + 1} are connected by a road.  For each i with 1 \le i \le \frac{k - 1}{2}, the roads connecting c_{2i} with c_{2i - 1} and c_{2i + 1} have the same color. For example if k = 5, the road between c_1 and c_2 must be the same color as the road between c_2 and c_3, and the road between c_3 and c_4 must be the same color as the road between c_4 and c_5.Vicky has a list of events in chronological order, where each event is either a delivery she must perform, or appearance of a new road. Help her determine which of her deliveries she will be able to complete.
Progress Monitoring                    

httpscodeforcescomproblemsetproblem509F

dp

2300

Programming teacher Dmitry Olegovich is going to propose the following task for one of his tests for studentsYou are given a tree T with n vertices specified by its adjacency matrix a1 n1 n What is the output of the following pseudocodeused1  n  0  0procedure dfsv    print v    usedv  1    for i  1 2  n        if avi  1 and usedi  0            dfsidfs1In order to simplify the test results checking procedure Dmitry Olegovich decided to create a tree T such that the result is his favorite sequence b On the other hand Dmitry Olegovich doesnt want to provide students with same trees as input otherwise they might cheat Thats why Dmitry Olegovich is trying to find out the number of different trees T such that the result of running the above pseudocode with T as input is exactly the sequence b Can you help himTwo trees with n vertices are called different if their adjacency matrices a1 and a2 are different i e there exists a pair ij such that 1ijn and a1ija2ij
Zipline                    

httpscodeforcescomproblemsetproblem650D

binary search

2600

Vasya has decided to build a zipline on trees of a nearby forest He wants the line to be as long as possible but he doesnt remember exactly the heights of all trees in the forest He is sure that he remembers correct heights of all trees except possibly one of themIt is known that the forest consists of n trees staying in a row numbered from left to right with integers from 1 to n According to Vasya the height of the ith tree is equal to hi The zipline of length k should hang over k 1kn trees i1i2ik i1i2ik such that their heights form an increasing sequence that is hi1hi2hikPetya had been in this forest together with Vasya and he now has q assumptions about the mistake in Vasyas sequence h His ith assumption consists of two integers ai and bi indicating that according to Petya the height of the tree numbered ai is actually equal to bi Note that Petyas assumptions are independent from each otherYour task is to find the maximum length of a zipline that can be built over the trees under each of the q assumptionsIn this problem the length of a zip line is considered equal to the number of trees that form this zipline
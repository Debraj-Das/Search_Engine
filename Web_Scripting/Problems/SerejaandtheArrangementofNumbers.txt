Sereja and the Arrangement of Numbers                    

httpscodeforcescomproblemsetproblem367C

graphs

2000

Lets call an array consisting of n integer numbers a1 a2  an beautiful if it has the following property  consider all pairs of numbers xy xy such that number x occurs in the array a and number y occurs in the array a  for each pair xy must exist some position j 1jn such that at least one of the two conditions are met either ajxaj1y or ajyaj1x Sereja wants to build a beautiful array a consisting of n integers But not everything is so easy Serejas friend Dima has m coupons each contains two integers qiwi Coupon i costs wi and allows you to use as many numbers qi as you want when constructing the array a Values qi are distinct Sereja has no coupons so Dima and Sereja have made the following deal Dima builds some beautiful array a of n elements After that he takes wi rubles from Sereja for each qi which occurs in the array a Sereja believed his friend and agreed to the contract and now he is wondering what is the maximum amount of money he can payHelp Sereja find the maximum amount of money he can pay to Dima
Research Rover                    

httpscodeforcescomproblemsetproblem722E

combinatorics

2900

Unfortunately the formal description of the task turned out to be too long so here is the legendResearch rover finally reached the surface of Mars and is ready to complete its mission Unfortunately due to the mistake in the navigation system design the rover is located in the wrong placeThe rover will operate on the grid consisting of n rows and m columns We will define as rc the cell located in the row r and column c From each cell the rover is able to move to any cell that share a side with the current oneThe rover is currently located at cell 11 and has to move to the cell nm It will randomly follow some shortest path between these two cells Each possible way is chosen equiprobablyThe cargo section of the rover contains the battery required to conduct the research Initially the battery charge is equal to s units of energySome of the cells contain anomaly Each time the rover gets to the cell with anomaly the battery looses half of its charge rounded down Formally if the charge was equal to x before the rover gets to the cell with anomaly the charge will change to While the rover picks a random shortest path to proceed compute the expected value of the battery charge after it reaches cell nm If the cells 11 and nm contain anomaly they also affect the charge of the battery
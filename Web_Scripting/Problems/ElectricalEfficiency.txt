Electrical Efficiency                    

https://codeforces.com/problemset/problem/1725/E

combinatorics

2500

In the country of Dengkleknesia, there are N factories numbered from 1 to N. Factory i has an electrical coefficient of A_i. There are also N-1 power lines with the j-th power line connecting factory U_j and factory V_j. It can be guaranteed that each factory in Dengkleknesia is connected to all other factories in Dengkleknesia through one or more power lines. In other words, the collection of factories forms a tree. Each pair of different factories in Dengkleknesia can use one or more existing power lines to transfer electricity to each other. However, each power line needs to be turned on first so that electricity can pass through it.Define f(x, y, z) as the minimum number of power lines that need to be turned on so that factory x can make electrical transfers to factory y and factory z. Also define g(x, y, z) as the number of distinct prime factors of \text{GCD}(A_x, A_y, A_z).To measure the electrical efficiency, you must find the sum of f(x, y, z) \times g(x, y, z) for all combinations of (x, y, z) such that 1 \leq x < y < z \leq N. Because the answer can be very large, you just need to output the answer modulo 998\,244\,353.Note: \text{GCD}(k_1, k_2, k_3) is the greatest common divisor of k_1, k_2, and k_3, which is the biggest integer that simultaneously divides k_1, k_2, and k_3.
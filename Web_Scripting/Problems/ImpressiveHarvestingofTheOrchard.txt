Impressive Harvesting of The Orchard                    

https://codeforces.com/problemset/problem/1425/I

data structures

2800

Mr. Chanek has an orchard structured as a rooted ternary tree with N vertices numbered from 1 to N. The root of the tree is vertex 1. P_i denotes the parent of vertex i, for (2 \le i \le N). Interestingly, the height of the tree is not greater than 10. Height of a tree is defined to be the largest distance from the root to a vertex in the tree.There exist a bush on each vertex of the tree. Initially, all bushes have fruits. Fruits will not grow on bushes that currently already have fruits. The bush at vertex i will grow fruits after A_i days since its last harvest.Mr. Chanek will visit his orchard for Q days. In day i, he will harvest all bushes that have fruits on the subtree of vertex X_i. For each day, determine the sum of distances from every harvested bush to X_i, and the number of harvested bush that day. Harvesting a bush means collecting all fruits on the bush.For example, if Mr. Chanek harvests all fruits on subtree of vertex X, and harvested bushes [Y_1, Y_2, \dots, Y_M], the sum of distances is \sum_{i = 1}^M \text{distance}(X, Y_i)\text{distance}(U, V) in a tree is defined to be the number of edges on the simple path from U to V.
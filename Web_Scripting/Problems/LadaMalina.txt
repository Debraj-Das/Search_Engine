Lada Malina                    

httpscodeforcescomproblemsetproblem853E

data structures

3400

After longterm research and lots of experiments leading Megapolian automobile manufacturer AutoVoz released a brand new car model named Lada Malina One of the most impressive features of Lada Malina is its highly efficient environmentfriendly enginesConsider car as a point in Oxy plane Car is equipped with k engines numbered from 1 to k Each engine is defined by its velocity vector whose coordinates are vxivyi measured in distance units per day An engine may be turned on at any level wi that is a real number between 1 and 1 inclusive that result in a term of wivxiwivyi in the final car velocity Namely the final car velocity is equal to w1vx1w2vx2wkvxkw1vy1w2vy2wkvyk Formally if car moves with constant values of wi during the whole day then its xcoordinate will change by the first component of an expression above and its ycoordinate will change by the second component of an expression above For example if all wi are equal to zero the car wont move and if all wi are equal to zero except w11 then car will move with the velocity of the first engineThere are n factories in Megapolia ith of them is located in fxifyi On the ith factory there are ai cars Lada Malina that are ready for operationAs an attempt to increase sales of a new car AutoVoz is going to hold an international exposition of cars There are q options of exposition location and time in the ith of them exposition will happen in a point with coordinates pxipyi in ti days Of course at the AutoVoz is going to bring as much new cars from factories as possible to the place of exposition Cars are going to be moved by enabling their engines on some certain levels such that at the beginning of an exposition car gets exactly to the exposition location However for some of the options it may be impossible to bring cars from some of the factories to the exposition location by the moment of an exposition Your task is to determine for each of the options of exposition location and time how many cars will be able to get there by the beginning of an exposition
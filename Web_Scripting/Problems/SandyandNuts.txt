Sandy and Nuts                    

httpscodeforcescomproblemsetproblem599E

bitmasks

2600

Rooted tree is a connected graph without any simple cycles with one vertex selected as a root In this problem the vertex number 1 will always serve as a rootLowest common ancestor of two vertices u and v is the farthest from the root vertex that lies on both the path from u to the root and on path from v to the root We will denote it as LCAuvSandy had a rooted tree consisting of n vertices that she used to store her nuts Unfortunately the underwater storm broke her tree and she doesnt remember all its edges She only managed to restore m edges of the initial tree and q triples ai bi and ci for which she supposes LCAaibiciHelp Sandy count the number of trees of size n with vertex 1 as a root that match all the information she remembered If she made a mess and there are no such trees then print 0 Two rooted trees are considered to be distinct if there exists an edge that occur in one of them and doesnt occur in the other one
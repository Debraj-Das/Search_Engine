Fractal Detector                    

httpscodeforcescomproblemsetproblem228C

dp

2000

Little Vasya likes painting fractals very muchHe does it like this First the boy cuts out a 22cell square out of squared paper Then he paints some cells black The boy calls the cut out square a fractal pattern Then he takes a clean square sheet of paper and paints a fractal by the following algorithm  He divides the sheet into four identical squares A part of them is painted black according to the fractal pattern  Each square that remained white is split into 4 lesser white squares some of them are painted according to the fractal pattern Each square that remained black is split into 4 lesser black squares  In each of the following steps step 2 repeats To draw a fractal the boy can make an arbitrary positive number of steps of the algorithm But he need to make at least two steps In other words step 2 of the algorithm must be done at least once The resulting picture the square with painted cells will be a fractal The figure below shows drawing a fractal here boy made three steps of the algorithm  One evening Vasya got very tired so he didnt paint the fractal he just took a sheet of paper painted a nmcell field Then Vasya paint some cells black Now he wonders how many squares are on the field such that there is a fractal which can be obtained as described above and which is equal to that square Square is considered equal to some fractal if they consist of the same amount of elementary not divided cells and for each elementary cell of the square corresponding elementary cell of the fractal have the same color
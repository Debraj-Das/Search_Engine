Anton and School  2                    

httpscodeforcescomproblemsetproblem785D

combinatorics

2300

As you probably know Anton goes to school One of the school subjects that Anton studies is Bracketology On the Bracketology lessons students usually learn different sequences that consist of round brackets characters  and  without quotesOn the last lesson Anton learned about the regular simple bracket sequences RSBS A bracket sequence s of length n is an RSBS if the following conditions are met  It is not empty that is n0  The length of the sequence is even  First  charactes of the sequence are equal to   Last  charactes of the sequence are equal to  For example the sequence  is an RSBS but the sequences  and  are not RSBSElena Ivanovna Antons teacher gave him the following task as a homework Given a bracket sequence s Find the number of its distinct subsequences such that they are RSBS Note that a subsequence of s is a string that can be obtained from s by deleting some of its elements Two subsequences are considered distinct if distinct sets of positions are deletedBecause the answer can be very big and Antons teacher doesnt like big numbers she asks Anton to find the answer modulo 1097Anton thought of this task for a very long time but he still doesnt know how to solve it Help Anton to solve this task and write a program that finds the answer for it
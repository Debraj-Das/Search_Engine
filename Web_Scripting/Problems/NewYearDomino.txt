New Year Domino                    

httpscodeforcescomproblemsetproblem500E

data structures

2300

Celebrating the new year many people post videos of falling dominoes Heres a list of them httpswwwyoutubecomresultssearchqueryNewYearsDominos User ainta who lives in a 2D world is going to post a video as wellThere are n dominoes on a 2D Cartesian plane ith domino 1in can be represented as a line segment which is parallel to the yaxis and whose length is li The lower point of the domino is on the xaxis Lets denote the xcoordinate of the ith domino as pi Dominoes are placed one after another so p1p2pn1pn holdsUser ainta wants to take a video of falling dominoes To make dominoes fall he can push a single domino to the right Then the domino will fall down drawing a circleshaped orbit until the line segment totally overlaps with the xaxis   Also if the sth domino touches the tth domino while falling down the tth domino will also fall down towards the right following the same procedure above Domino s touches domino t if and only if the segment representing s and t intersects   See the picture above If he pushes the leftmost domino to the right it falls down touching dominoes A B and C As a result dominoes A B C will also fall towards the right However domino D wont be affected by pushing the leftmost domino but eventually it will fall because it is touched by domino C for the first time  The picture above is an example of falling dominoes Each red circle denotes a touch of two dominoesUser ainta has q plans of posting the video jth of them starts with pushing the xjth domino and lasts until the yjth domino falls But sometimes it could be impossible to achieve such plan so he has to lengthen some dominoes It costs one dollar to increase the length of a single domino by 1 User ainta wants to know for each plan the minimum cost needed to achieve it Plans are processed independently i e if dominos length is increased in some plan it doesnt affect its length in other plans Set of dominos that will fall except xjth domino and yjth domino doesnt matter but the initial push should be on domino xj
Kolya and Tanya                     

httpscodeforcescomproblemsetproblem584B

combinatorics

1500

Kolya loves putting gnomes at the circle table and giving them coins and Tanya loves studying triplets of gnomes sitting in the vertexes of an equilateral triangleMore formally there are 3n gnomes sitting in a circle Each gnome can have from 1 to 3 coins Lets number the places in the order they occur in the circle by numbers from 0 to 3n1 let the gnome sitting on the ith place have ai coins If there is an integer i 0in such that aiainai2n6 then Tanya is satisfied Count the number of ways to choose ai so that Tanya is satisfied As there can be many ways of distributing coins print the remainder of this number modulo 1097 Two ways a and b are considered distinct if there is index i 0i3n such that aibi that is some gnome got different number of coins in these two ways
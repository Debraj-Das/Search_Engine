Script Generation                    

httpscodeforcescomproblemsetproblem177F2



2300

The Smart Beaver from ABBYY was offered a job of a screenwriter for the ongoing TV series In particular he needs to automate the hard decision which main characters will get married by the end of the seriesThere are n single men and n single women among the main characters An opinion poll showed that viewers like several couples and a marriage of any of them will make the audience happy The Smart Beaver formalized this fact as k triples of numbers hwr where h is the index of the man w is the index of the woman and r is the measure of the audiences delight in case of the marriage of this couple The same poll showed that the marriage of any other couple will leave the audience indifferent so the screenwriters decided not to include any such marriages in the plotThe script allows you to arrange several marriages between the heroes or not to arrange marriages at all A subset of some of the k marriages is considered acceptable if each man and each woman is involved in at most one marriage of the subset the series wont allow any divorces The value of the acceptable set of marriages is the total delight the spectators will get from the marriages included in this setObviously there is a finite number of acceptable sets and they all describe some variants of the script The screenwriters do not want to choose a set with maximum value  it would make the plot too predictable So the Smart Beaver offers the following option sort all the acceptable sets in increasing order of value and choose the tth set from the sorted list Thus t1 corresponds to a plot without marriages t2  to a single marriage resulting in minimal delight for the audience and so onHelp the Beaver to implement the algorithm for selecting the desired set
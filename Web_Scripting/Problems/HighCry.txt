High Cry                    

httpscodeforcescomproblemsetproblem875D

binary search

2200

Disclaimer there are lots of untranslateable puns in the Russian version of the statement so there is one more reason for you to learn Russian Rick and Morty like to go to the ridge High Cry for crying loudly there is an extraordinary echo Recently they discovered an interesting acoustic characteristic of this ridge if Rick and Morty begin crying simultaneously from different mountains their cry would be heard between these mountains up to the height equal the bitwise OR of mountains theyve climbed and all the mountains between them Bitwise OR is a binary operation which is determined the following way Consider representation of numbers x and y in binary numeric system probably with leading zeroes xxk x1x0 and yyk y1y0 Then zxy is defined following way zzk z1z0 where zi1 if xi1 or yi1 and zi0 otherwise In the other words digit of bitwise OR of two numbers equals zero if and only if digits at corresponding positions is both numbers equals zero For example bitwise OR of numbers 1010102 and 910012 equals 1110112 In programming languages CCJavaPython this operation is defined as  and in Pascal as orHelp Rick and Morty calculate the number of ways they can select two mountains in such a way that if they start crying from these mountains their cry will be heard above these mountains and all mountains between them More formally you should find number of pairs l and r 1lrn such that bitwise OR of heights of all mountains between l and r inclusive is larger than the height of any mountain at this interval
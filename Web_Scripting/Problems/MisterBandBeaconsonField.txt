Mister B and Beacons on Field                    

httpscodeforcescomproblemsetproblem819C

number theory

2900

Mister B has a house in the middle of a giant plain field which attracted aliens life For convenience aliens specified the Cartesian coordinate system on the field in such a way that Mister Bs house has coordinates 00 After that they sent three beacons to the field but something went wrong One beacon was completely destroyed while the other two landed in positions with coordinates m0 and 0n respectively but shut downMister B was interested in this devices so he decided to take them home He came to the first beacon placed at m0 lifted it up and carried the beacon home choosing the shortest path After that he came to the other beacon placed at 0n and also carried it home choosing the shortest path When first beacon was lifted up the navigation system of the beacons was activatedPartially destroyed navigation system started to work in following wayAt time moments when both survived beacons are at points with integer coordinates the system tries to find a location for the third beacon It succeeds if and only if there is a point with integer coordinates such that the area of the triangle formed by the two survived beacons and this point is equal to s In this case the system sends a packet of information with beacon positions to aliens otherwise it doesntCompute how many packets of information system sent while Mister B was moving the beacons
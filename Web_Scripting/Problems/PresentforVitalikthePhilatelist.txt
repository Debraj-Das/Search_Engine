Present for Vitalik the Philatelist                     

httpscodeforcescomproblemsetproblem585E

combinatorics

2900

Vitalik the philatelist has a birthday todayAs he is a regular customer in a stamp store called Robin Bobin the store management decided to make him a giftVitalik wants to buy one stamp and the store will give him a nonempty set of the remaining stamps such that the greatest common divisor GCD of the price of the stamps they give to him is more than one If the GCD of prices of the purchased stamp and prices of present stamps set will be equal to 1 then Vitalik will leave the store completely happyThe store management asks you to count the number of different situations in which Vitalik will leave the store completely happy Since the required number of situations can be very large you need to find the remainder of this number modulo 1097 The situations are different if the stamps purchased by Vitalik are different or if one of the present sets contains a stamp that the other present does not contain
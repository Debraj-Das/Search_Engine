Vasya and Magic Matrix                    

https://codeforces.com/problemset/problem/1042/E

dp

2300

Vasya has got a magic matrix a of size n \times m. The rows of the matrix are numbered from 1 to n from top to bottom, the columns are numbered from 1 to m from left to right. Let a_{ij} be the element in the intersection of the i-th row and the j-th column.Vasya has also got a chip. Initially, the chip is in the intersection of the r-th row and the c-th column (that is, in the element a_{rc}). Vasya performs the following process as long as possible: among all elements of the matrix having their value less than the value of the element with the chip in it, Vasya randomly and equiprobably chooses one element and moves his chip to this element.After moving the chip, he adds to his score the square of the Euclidean distance between these elements (that is, between the element in which the chip is now and the element the chip was moved from). The process ends when there are no elements having their values less than the value of the element with the chip in it.Euclidean distance between matrix elements with coordinates (i_1, j_1) and (i_2, j_2) is equal to \sqrt{(i_1-i_2)^2 + (j_1-j_2)^2}.Calculate the expected value of the Vasya's final score.It can be shown that the answer can be represented as \frac{P}{Q}, where P and Q are coprime integer numbers, and Q \not\equiv 0~(mod ~ 998244353). Print the value P \cdot Q^{-1} modulo 998244353.
Pilgrims                    

httpscodeforcescomproblemsetproblem348E

dfs and similar

2800

A long time ago there was a land called Dudeland Dudeland consisted of n towns connected with n1 bidirectonal roads The towns are indexed from 1 to n and one can reach any city from any other city if he moves along the roads of the country There are m monasteries in Dudeland located in m different towns In each monastery lives a pilgrimAt the beginning of the year each pilgrim writes down which monastery is the farthest from the monastery he is living in If there is more than one farthest monastery he lists all of them On the Big Lebowski day each pilgrim picks one town from his paper at random and starts walking to that town Walter hates pilgrims and wants to make as many of them unhappy as possible by preventing them from finishing their journey He plans to destroy exactly one town that does not contain a monastery A pilgrim becomes unhappy if all monasteries in his list become unreachable from the monastery he is living in You need to find the maximum number of pilgrims Walter can make unhappy Also find the number of ways he can make this maximal number of pilgrims unhappy the number of possible towns he can destroy
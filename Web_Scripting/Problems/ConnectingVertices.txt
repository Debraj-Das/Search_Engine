Connecting Vertices                    

httpscodeforcescomproblemsetproblem888F

dp

2500

There are n points marked on the plane The points are situated in such a way that they form a regular polygon marked points are its vertices and they are numbered in counterclockwise order You can draw n1 segments each connecting any two marked points in such a way that all points have to be connected with each other directly or indirectlyBut there are some restrictions Firstly some pairs of points cannot be connected directly and have to be connected undirectly Secondly the segments you draw must not intersect in any point apart from the marked points that is if any two segments intersect and their intersection is not a marked point then the picture you have drawn is invalidHow many ways are there to connect all vertices with n1 segments Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection but it is not drawn between these points in the second one Since the answer might be large output it modulo 1097
Find a car                    

httpscodeforcescomproblemsetproblem809C

combinatorics

2600

After a wonderful evening in the restaurant the time to go home came Leha as a true gentlemen suggested Noora to give her a lift Certainly the girl agreed with pleasure Suddenly one problem appeared Leha cannot find his car on a huge parking near the restaurant So he decided to turn to the watchman for helpFormally the parking can be represented as a matrix 109109 There is exactly one car in every cell of the matrix All cars have their own machine numbers represented as a positive integer Lets index the columns of the matrix by integers from 1 to 109 from left to right and the rows by integers from 1 to 109 from top to bottom By coincidence it turned out that for every cell xy the number of the car which stands in this cell is equal to the minimum positive integer which cant be found in the cells iy and xj 1ix1jy  The upper left fragment 55 of the parking Leha wants to ask the watchman q requests which can help him to find his car Every request is represented as five integers x1y1x2y2k The watchman have to consider all cells xy of the matrix such that x1xx2 and y1yy2 and if the number of the car in cell xy does not exceed k increase the answer to the request by the number of the car in cell xy For each request Leha asks the watchman to tell him the resulting sum Due to the fact that the sum can turn out to be quite large hacker asks to calculate it modulo 1097However the requests seem to be impracticable for the watchman Help the watchman to answer all Lehas requests
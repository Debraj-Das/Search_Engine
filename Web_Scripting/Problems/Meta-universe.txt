Metauniverse                    

httpscodeforcescomproblemsetproblem475F

data structures

2900

Consider infinite grid of unit cells Some of those cells are planets Metauniverse Mp1p2pk is a set of planets Suppose there is an infinite row or column with following two properties 1 it doesnt contain any planet pi of metauniverse M on it 2 there are planets of M located on both sides from this row or column In this case we can turn the metauniverse M into two nonempty metauniverses M1 and M2 containing planets that are located on respective sides of this row or column A metauniverse which cant be split using operation above is called a universe We perform such operations until all metauniverses turn to universesGiven positions of the planets in the original metauniverse find the number of universes that are result of described process It can be proved that each universe is uniquely identified not depending from order of splitting
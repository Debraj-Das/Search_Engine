Book of Evil                    

httpscodeforcescomproblemsetproblem337D

dfs and similar

2000

Paladin Manao caught the trail of the ancient Book of Evil in a swampy area This area contains n settlements numbered from 1 to n Moving through the swamp is very difficult so people tramped exactly n1 paths Each of these paths connects some pair of settlements and is bidirectional Moreover it is possible to reach any settlement from any other one by traversing one or several pathsThe distance between two settlements is the minimum number of paths that have to be crossed to get from one settlement to the other one Manao knows that the Book of Evil has got a damage range d This means that if the Book of Evil is located in some settlement its damage for example emergence of ghosts and werewolves affects other settlements at distance d or less from the settlement where the Book residesManao has heard of m settlements affected by the Book of Evil Their numbers are p1p2pm Note that the Book may be affecting other settlements as well but this has not been detected yet Manao wants to determine which settlements may contain the Book Help him with this difficult task
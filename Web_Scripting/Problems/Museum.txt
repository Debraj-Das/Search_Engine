Museum                    

httpscodeforcescomproblemsetproblem113D

math

2700

One day as Petya and his friend Vasya were having one of their numerous trips they decided to visit a museum castle The museum has a specific shape it consists of n rooms connected with m corridors so that one can access any room from any other oneAfter the two friends had a little walk around the museum they decided to split and watch the pieces of art each of them found interesting They agreed to meet in one of the rooms at six pm However they forgot one quite essential thing they didnt specify the place to meet and when the time came they started to rush about the museum looking for each other they couldnt call each other as roaming made a calls cost skyrocketYet even despite the whole rush they couldnt get enough of the pieces of art thats why each of them has the following strategy each minute he make a decision where to go  with probability pi he doesnt move to any other place during this minute ie he stays in the room With probability 1pi he equiprobably choose one of the adjacent rooms and went there along the corridor Here i is the ordinal number of the current room Building was expensive in ancient times thats why each corridor connected two different rooms and any two rooms had no more than one corridor between them The boys act simultaneously As the corridors are dark it is impossible to meet there however one can walk along the corridors in both directions besides the two boys can be going through the same corridor simultaneously without meeting The boys act like that until they meet each other More formally the two friends meet when at some moment of time both of them decided to appear in the same roomFor each room find the probability that the boys will meet there considering that at 6 pm they are positioned in rooms a and b correspondingly
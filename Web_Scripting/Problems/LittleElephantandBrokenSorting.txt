Little Elephant and Broken Sorting                    

httpscodeforcescomproblemsetproblem258D

dp

2600

The Little Elephant loves permutations of integers from 1 to n very much But most of all he loves sorting them To sort a permutation the Little Elephant repeatedly swaps some elements As a result he must receive a permutation 123nThis time the Little Elephant has permutation p1p2pn Its sorting program needs to make exactly m moves during the ith move it swaps elements that are at that moment located at the aith and the bith positions But the Little Elephants sorting program happened to break down and now on every step it can equiprobably either do nothing or swap the required elementsNow the Little Elephant doesnt even hope that the program will sort the permutation but he still wonders if he runs the program and gets some permutation how much will the result of sorting resemble the sorted one For that help the Little Elephant find the mathematical expectation of the number of permutation inversions after all moves of the program are completedWell call a pair of integers ij 1ijn an inversion in permutatuon p1p2pn if the following inequality holds pipj
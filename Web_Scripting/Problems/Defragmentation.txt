Defragmentation                    

httpscodeforcescomproblemsetproblem180A

implementation

1800

In this problem you have to implement an algorithm to defragment your hard disk The hard disk consists of a sequence of clusters numbered by integers from 1 to n The disk has m recorded files the ith file occupies clusters with numbers ai1 ai2  aini These clusters are not necessarily located consecutively on the disk but the order in which they are given corresponds to their sequence in the file cluster ai1 contains the first fragment of the ith file cluster ai2 has the second fragment etc Also the disc must have one or several clusters which are free from filesYou are permitted to perform operations of copying the contents of cluster number i to cluster number j i and j must be different Moreover if the cluster number j used to keep some information it is lost forever Clusters are not cleaned but after the defragmentation is complete some of them are simply declared unusable although they may possibly still contain some fragments of filesYour task is to use a sequence of copy operations to ensure that each file occupies a contiguous area of memory Each file should occupy a consecutive cluster section the files must follow one after another from the beginning of the hard disk After defragmentation all free unused clusters should be at the end of the hard disk After defragmenting files can be placed in an arbitrary order Clusters of each file should go consecutively from first to last See explanatory examples in the notesPrint the sequence of operations leading to the disk defragmentation Note that you do not have to minimize the number of operations but it should not exceed 2n
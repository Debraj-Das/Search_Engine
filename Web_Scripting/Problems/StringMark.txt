String Mark                    

httpscodeforcescomproblemsetproblem895D

combinatorics

2100

At the Byteland State University marks are strings of the same length Mark x is considered better than y if string y is lexicographically smaller than xRecently at the BSU was an important test work on which Vasya recived the mark a It is very hard for the teacher to remember the exact mark of every student but he knows the mark b such that every student recieved mark strictly smaller than bVasya isnt satisfied with his mark so he decided to improve it He can swap characters in the string corresponding to his mark as many times as he like Now he want to know only the number of different ways to improve his mark so that his teacher didnt notice something suspiciousMore formally you are given two strings a b of the same length and you need to figure out the number of different strings c such that1 c can be obtained from a by swapping some characters in other words c is a permutation of a2 String a is lexicographically smaller than c3 String c is lexicographically smaller than bFor two strings x and y of the same length it is true that x is lexicographically smaller than y if there exists such i that x1y1x2y2xi1yi1xiyiSince the answer can be very large you need to find answer modulo 1097
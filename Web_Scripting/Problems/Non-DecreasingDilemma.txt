Non-Decreasing Dilemma                    

https://codeforces.com/problemset/problem/1567/E

data structures

2200

Alice has recently received an array a_1, a_2, \dots, a_n for her birthday! She is very proud of her array, and when she showed her friend Bob the array, he was very happy with her present too!However, soon Bob became curious, and as any sane friend would do, asked Alice to perform q operations of two types on her array:  1 x y: update the element a_x to y (set a_x = y).  2 l r: calculate how many non-decreasing subarrays exist within the subarray [a_l, a_{l+1}, \dots, a_r]. More formally, count the number of pairs of integers (p,q) such that l \le p \le q \le r and a_p \le a_{p+1} \le \dots \le a_{q-1} \le a_q. Help Alice answer Bob's queries!
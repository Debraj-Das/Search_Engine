The Labyrinth                    

httpscodeforcescomproblemsetproblem616C

dfs and similar

1600

You are given a rectangular field of nm cells Each cell is either empty or impassable contains an obstacle Empty cells are marked with  impassable cells are marked with  Lets call two empty cells adjacent if they share a sideLets call a connected component any nonextendible set of cells such that any two of them are connected by the path of adjacent cells It is a typical wellknown definition of a connected componentFor each impassable cell xy imagine that it is an empty cell all other cells remain unchanged and find the size the number of cells of the connected component which contains xy You should do it for each impassable cell independentlyThe answer should be printed as a matrix with n rows and m columns The jth symbol of the ith row should be  if the cell is empty at the start Otherwise the jth symbol of the ith row should contain the only digit  the answer modulo 10 The matrix should be printed without any spacesTo make your output faster it is recommended to build the output as an array of n strings having length m and print it as a sequence of lines It will be much faster than writing characterbycharacterAs inputoutput can reach huge size it is recommended to use fast inputoutput methods for example prefer to use scanfprintf instead of cincout in C prefer to use BufferedReaderPrintWriter instead of ScannerSystemout in Java
Erase and Extend (Hard Version)                    

https://codeforces.com/problemset/problem/1537/E2

binary search

2200

This is the hard version of the problem. The only difference is the constraints on n and k. You can make hacks only if all versions of the problem are solved.You have a string s, and you can do two types of operations on it:   Delete the last character of the string.  Duplicate the string: s:=s+s, where + denotes concatenation. You can use each operation any number of times (possibly none).Your task is to find the lexicographically smallest string of length exactly k that can be obtained by doing these operations on string s.A string a is lexicographically smaller than a string b if and only if one of the following holds:  a is a prefix of b, but a\ne b;  In the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b. 
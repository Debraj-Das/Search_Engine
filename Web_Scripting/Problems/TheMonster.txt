The Monster                    

httpscodeforcescomproblemsetproblem917A

dp

1800

As Will is stuck in the Upside Down he can still communicate with his mom Joyce through the Christmas lights he can turn them on and off with his mind He cant directly tell his mom where he is because the monster that took him to the Upside Down will know and relocate him   Thus he came up with a puzzle to tell his mom his coordinates His coordinates are the answer to the following problemA string consisting only of parentheses  and  is called a bracket sequence Some bracket sequence are called correct bracket sequences More formally  Empty string is a correct bracket sequence  if s is a correct bracket sequence then s is also a correct bracket sequence  if s and t are correct bracket sequences then st concatenation of s and t is also a correct bracket sequence A string consisting of parentheses and question marks  is called pretty if and only if theres a way to replace each question mark with either  or  such that the resulting string is a nonempty correct bracket sequenceWill gave his mom a string s consisting of parentheses and question marks using Morse code through the lights and his coordinates are the number of pairs of integers lr such that 1lrs and the string slsl1 sr is pretty where si is ith character of sJoyce doesnt know anything about bracket sequences so she asked for your help
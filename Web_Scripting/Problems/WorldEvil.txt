World Evil                    

httpscodeforcescomproblemsetproblem62E

dp

2700

As a result of Pinky and Brains mysterious experiments in the Large Hadron Collider some portals or black holes opened to the parallel dimension And the World Evil has crept to the veil between their world and ours Brain quickly evaluated the situation and he understood that the more evil tentacles creep out and become free the higher is the possibility that Brain will rule the worldThe colliders constriction is a rectangular grid rolled into a cylinder and consisting of n rows and m columns such as is shown in the picture below  In this example n4 m5 Dotted lines are corridores that close each column to a ring i e connect the nth and the 1th rows of the gridIn the leftmost column of the grid the portals are situated and the tentacles of the World Evil are ready to creep out from there In the rightmost column the exit doors are located The tentacles can only get out through those doors The segments joining the nodes of the grid are corridorsBrain would be glad to let all the tentacles out but he faces a problem the infinite number of tentacles can creep out of the portals every tentacle possesses infinite length and some width and the volume of the corridors are unfortunately quite limited Brain could approximately evaluate the maximal number of tentacles that will be able to crawl through every corridorNow help the mice to determine the maximal number of tentacles of the World Evil that will crawl out of the Large Hadron Collider
Playing on Graph                    

httpscodeforcescomproblemsetproblem542E

graphs

2600

Vova and Marina love offering puzzles to each other Today Marina offered Vova to cope with the following taskVova has a nondirected graph consisting of n vertices and m edges without loops and multiple edges Lets define the operation of contraction two vertices a and b that are not connected by an edge As a result of this operation vertices a and b are deleted and instead of them a new vertex x is added into the graph and also edges are drawn from it to all vertices that were connected with a or with b specifically if the vertex was connected with both a and b then also exactly one edge is added from x to it Thus as a result of contraction again a nondirected graph is formed it contains no loops nor multiple edges and it contains n1 verticesVova must perform the contraction an arbitrary number of times to transform the given graph into a chain of the maximum length A chain of length k k0 is a connected graph whose vertices can be numbered with integers from 1 to k1 so that the edges of the graph connect all pairs of vertices ii1 1ik and only them Specifically the graph that consists of one vertex is a chain of length 0 The vertices that are formed as a result of the contraction are allowed to be used in the following operations of contraction  The picture illustrates the contraction of two vertices marked by red Help Vova cope with his girlfriends task Find the maximum length of the chain that can be obtained from the resulting graph or else determine that it is impossible to obtain the chain
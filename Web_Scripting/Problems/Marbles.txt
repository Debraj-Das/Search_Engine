Marbles                    

httpscodeforcescomproblemsetproblem607C

hashing

2500

In the spirit of the holidays Saitama has given Genos two grid paths of length n a weird gift even by Saitamas standards A grid path is an ordered sequence of neighbouring squares in an infinite grid Two squares are neighbouring if they share a sideOne example of a grid path is 00010212110111 Note that squares in this sequence might be repeated ie path has self intersectionsMovement within a grid path is restricted to adjacent squares within the sequence That is from the ith square one can only move to the i1th or i1th squares of this path Note that there is only a single valid move from the first and last squares of a grid path Also note that even if there is some jth square of the path that coincides with the ith square only moves to i1th and i1th squares are available For example from the second square in the above sequence one can only move to either the first or third squaresTo ensure that movement is not ambiguous the two grid paths will not have an alternating sequence of three squares For example a contiguous subsequence 000100 cannot occur in a valid grid pathOne marble is placed on the first square of each grid path Genos wants to get both marbles to the last square of each grid path However there is a catch Whenever he moves one marble the other marble will copy its movement if possible For instance if one marble moves east then the other marble will try and move east as well By try we mean if moving east is a valid move then the marble will move eastMoving north increases the second coordinate by 1 while moving south decreases it by 1 Similarly moving east increases first coordinate by 1 while moving west decreases itGiven these two valid grid paths Genos wants to know if it is possible to move both marbles to the ends of their respective paths That is if it is possible to move the marbles such that both marbles rest on the last square of their respective paths
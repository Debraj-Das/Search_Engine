New Year and Ancient Prophecy                    

httpscodeforcescomproblemsetproblem611D

dp

2000

Limak is a little polar bear In the snow he found a scroll with the ancient prophecy Limak doesnt know any ancient languages and thus is unable to understand the prophecy But he knows digitsOne fragment of the prophecy is a sequence of n digits The first digit isnt zero Limak thinks that its a list of some special years Its hard to see any commas or spaces so maybe ancient people didnt use them Now Limak wonders what years are listed thereLimak assumes three things  Years are listed in the strictly increasing order  Every year is a positive integer number  There are no leading zeros Limak is going to consider all possible ways to split a sequence into numbers years satisfying the conditions above He will do it without any help However he asked you to tell him the number of ways to do so Since this number may be very large you are only asked to calculate it modulo 1097
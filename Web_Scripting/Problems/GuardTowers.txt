Guard Towers                    

httpscodeforcescomproblemsetproblem85E

binary search

2600

In a far away kingdom lives a very greedy king To defend his land he built n guard towers Apart from the towers the kingdom has two armies each headed by a tyrannical and narcissistic general The generals cant stand each other specifically they will never let soldiers of two armies be present in one towerDuring defence operations to manage a guard tower a general has to send part of his army to that tower Each general asks some fee from the king for managing towers As they live in a really far away kingdom each general evaluates his fee in the following weird manner he finds two remotest the most distant towers where the soldiers of his army are situated and asks for the fee equal to the distance Each tower is represented by a point on the plane with coordinates xy and the distance between two points with coordinates x1y1 and x2y2 is determined in this kingdom as x1x2y1y2The greedy king was not exactly satisfied with such a requirement from the generals thats why he only agreed to pay one fee for two generals equal to the maximum of two demanded fees However the king is still green with greed and among all the ways to arrange towers between armies he wants to find the cheapest one Each tower should be occupied by soldiers of exactly one armyHe hired you for that You should find the minimum amount of money that will be enough to pay the fees And as the king is also very scrupulous you should also count the number of arrangements that will cost the same amount of money As their number can be quite large it is enough for the king to know it as a remainder from dividing by 1097Two arrangements are distinct if the sets of towers occupied by soldiers of the first general are distinct
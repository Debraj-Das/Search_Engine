Incorrect Flow                    

httpscodeforcescomproblemsetproblem708D

flows

2900

At the entrance examination for the magistracy of the MSU CyberMechanics Department Sasha got the question about FordFulkerson algorithm He knew the topic perfectly as he worked with it many times on programming competition As the task for the question he was given a network with partially build flow that he had to use in order to demonstrate the workflow of the algorithm He quickly finished to write the text and took a look at the problem only to understand that the given network is incorrectSuppose you are given a directed graph GVE with two special nodes s and t called source and sink We denote as n the number of nodes in the graph ie nV and m stands for the number of directed edges in the graph ie mE For the purpose of this problem we always consider node 1 to be the source and node n to be the sink In addition for each edge of the graph e we define the capacity function ce and flow function fe Function fe represents the correct flow if the following conditions are satisfied  For each edge  the flow is nonnegative and does not exceed capacity ce ie 0fece  For each node  that is not source or sink vs and vt the sum of flows of all edges going in v is equal to the sum of the flows among all edges going out from v In other words there is no flow stuck in v It was clear that as the exam was prepared last night and there are plenty of mistakes in the tasks Sasha asked one of the professors to fix the network or give the correct task but the reply was that the magistrate student should be able to fix the network himself As the professor doesnt want the task to become easier he asks Sasha to fix the network in a such way that the total number of changes is minimum possible Sasha is not allowed to remove edges add new ones or reverse the direction of existing edges The only thing he is able to do is to change capacity function ce and flow function fe Moreover all the values should remain nonnegative integers There is no requirement on the flow to be maximum in any senseFind the minimum possible total change of the functions fe and ce that Sasha has to make in order to make the flow correct The total change is defined as the sum of absolute differences ie if new functions are fe and ce then the total change is 
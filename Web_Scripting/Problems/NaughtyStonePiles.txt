Naughty Stone Piles                    

httpscodeforcescomproblemsetproblem226B

greedy

1900

There are n piles of stones of sizes a1a2an lying on the table in front of youDuring one move you can take one pile and add it to the other As you add pile i to pile j the size of pile j increases by the current size of pile i and pile i stops existing The cost of the adding operation equals the size of the added pileYour task is to determine the minimum cost at which you can gather all stones in one pile To add some challenge the stone piles built up conspiracy and decided that each pile will let you add to it not more than k times after that it can only be added to another pile Moreover the piles decided to puzzle you completely and told you q variants not necessarily distinct of what k might equal Your task is to find the minimum cost for each of q variants
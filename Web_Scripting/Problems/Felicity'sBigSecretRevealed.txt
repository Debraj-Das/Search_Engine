Felicitys Big Secret Revealed                    

httpscodeforcescomproblemsetproblem757D

bitmasks

2200

The gym leaders were fascinated by the evolutions which took place at Felicity camp So they were curious to know about the secret behind evolving Pokemon The organizers of the camp gave the gym leaders a PokeBlock a sequence of n ingredients Each ingredient can be of type 0 or 1 Now the organizers told the gym leaders that to evolve a Pokemon of type k k2 they need to make a valid set of k cuts on the PokeBlock to get smaller blocksSuppose the given PokeBlock sequence is b0b1b2 bn1 You have a choice of making cuts at n1 places ie Before b0 between b0 and b1 between b1 and b2  between bn2 and bn1 and after bn1The n1 choices of making cuts are as follows where a  denotes a possible cut b0  b1  b2    bn2  bn1 Consider a sequence of k cuts Now each pair of consecutive cuts will contain a binary string between them formed from the ingredient types The ingredients before the first cut and after the last cut are wasted which is to say they are not considered So there will be exactly k1 such binary substrings Every substring can be read as a binary number Let m be the maximum number out of the obtained numbers If all the obtained numbers are positive and the set of the obtained numbers contains all integers from 1 to m then this set of cuts is said to be a valid set of cutsFor example suppose the given PokeBlock sequence is 101101001110 and we made 5 cuts in the following way10  11  010  01  1  10So the 4 binary substrings obtained are 11 010 01 and 1 which correspond to the numbers 3 2 1 and 1 respectively Here m3 as it is the maximum value among the obtained numbers And all the obtained numbers are positive and we have obtained all integers from 1 to m Hence this set of cuts is a valid set of 5 cutsA Pokemon of type k will evolve only if the PokeBlock is cut using a valid set of k cuts There can be many valid sets of the same size Two valid sets of k cuts are considered different if there is a cut in one set which is not there in the other setLet fk denote the number of valid sets of k cuts Find the value of  Since the value of s can be very large output s modulo 1097
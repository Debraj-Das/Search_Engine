Tick, Tock                    

https://codeforces.com/problemset/problem/1758/E

combinatorics

2500

Tannhaus, the clockmaker in the town of Winden, makes mysterious clocks that measure time in h hours numbered from 0 to h-1. One day, he decided to make a puzzle with these clocks. The puzzle consists of an n \times m grid of clocks, and each clock always displays some hour exactly (that is, it doesn't lie between two hours). In one move, he can choose any row or column and shift all clocks in that row or column one hour forward^\dagger.The grid of clocks is called solvable if it is possible to make all the clocks display the same time.While building his puzzle, Tannhaus suddenly got worried that it might not be possible to make the grid solvable. Some cells of the grid have clocks already displaying a certain initial time, while the rest of the cells are empty.Given the partially completed grid of clocks, find the number of ways^\ddagger to assign clocks in the empty cells so that the grid is solvable. The answer can be enormous, so compute it modulo 10^9 + 7.^\dagger If a clock currently displays hour t and is shifted one hour forward, then the clock will instead display hour (t+1) \bmod h.^\ddagger Two assignments are different if there exists some cell with a clock that displays a different time in both arrangements.
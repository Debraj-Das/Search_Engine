Kyoya and Permutation                    

httpscodeforcescomproblemsetproblem553B

binary search

1900

Lets define the permutation of length n as an array pp1p2pn consisting of n distinct integers from range from 1 to n We say that this permutation maps value 1 into the value p1 value 2 into the value p2 and so onKyota Ootori has just learned about cyclic representation of a permutation A cycle is a sequence of numbers such that each element of this sequence is being mapped into the next element of this sequence and the last element of the cycle is being mapped into the first element of the cycle The cyclic representation is a representation of p as a collection of cycles forming p For example permutation p416253 has a cyclic representation that looks like 142365 because 1 is replaced by 4 4 is replaced by 2 2 is replaced by 1 3 and 6 are swapped and 5 remains in place Permutation may have several cyclic representations so Kyoya defines the standard cyclic representation of a permutation as follows First reorder the elements within each cycle so the largest element is first Then reorder all of the cycles so they are sorted by their first element For our example above the standard cyclic representation of 416253 is 421563Now Kyoya notices that if we drop the parenthesis in the standard cyclic representation we get another permutation For instance 416253 will become 421563Kyoya notices that some permutations dont change after applying operation described above at all He wrote all permutations of length n that do not change in a list in lexicographic order Unfortunately his friend Tamaki Suoh lost this list Kyoya wishes to reproduce the list and he needs your help Given the integers n and k print the permutation that was kth on Kyoyas list
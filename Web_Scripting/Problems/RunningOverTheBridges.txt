Running Over The Bridges                    

httpscodeforcescomproblemsetproblem730D

greedy

2200

Polycarp is playing a game called Running Over The Bridges In this game he has to run over n bridges from the left to the right Bridges are arranged one after the other so the ith bridge begins where the i1th bridge endsYou have the following data about bridges li and ti  the length of the ith bridge and the maximum allowed time which Polycarp can spend running over the ith bridge Thus if Polycarp is in the beginning of the bridge i at the time T then he has to leave it at the time Tti or earlier It is allowed to reach the right end of a bridge exactly at the time TtiPolycarp can run from the left side to the right one with speed 05 so he will run over a bridge with length s in time 2s Besides he has several magical drinks If he uses one drink his speed increases twice ie to value 1 for r seconds All magical drinks are identical Please note that Polycarp can use a drink only at integer moments of time and he drinks it instantly and completely Additionally if Polycarp uses a drink at the moment T he can use the next drink not earlier than at the moment TrWhat is the minimal number of drinks Polycarp has to use to run over all n bridges If this number is not greater than 105 then you have to find out the moments of time when Polycarp has to use each magical drink
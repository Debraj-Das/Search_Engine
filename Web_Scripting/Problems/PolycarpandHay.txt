Polycarp and Hay                    

httpscodeforcescomproblemsetproblem659F

dfs and similar

2000

The farmer Polycarp has a warehouse with hay which can be represented as an nm rectangular table where n is the number of rows and m is the number of columns in the table Each cell of the table contains a haystack The height in meters of the hay located in the ith row and the jth column is equal to an integer aij and coincides with the number of cubic meters of hay in the haystack because all cells have the size of the base 11 Polycarp has decided to tidy up in the warehouse by removing an arbitrary integer amount of cubic meters of hay from the top of each stack You can take different amounts of hay from different haystacks Besides it is allowed not to touch a stack at all or on the contrary to remove it completely If a stack is completely removed the corresponding cell becomes empty and no longer contains the stackPolycarp wants the following requirements to hold after the reorganization  the total amount of hay remaining in the warehouse must be equal to k  the heights of all stacks ie cells containing a nonzero amount of hay should be the same  the height of at least one stack must remain the same as it was  for the stability of the remaining structure all the stacks should form one connected region The two stacks are considered adjacent if they share a side in the table The area is called connected if from any of the stack in the area you can get to any other stack in this area moving only to adjacent stacks In this case two adjacent stacks necessarily belong to the same areaHelp Polycarp complete this challenging task or inform that it is impossible
Madoka and the Sixth-graders                    

https://codeforces.com/problemset/problem/1647/E

data structures

2500

After the most stunning success with the fifth-graders, Madoka has been trusted with teaching the sixth-graders.There's n single-place desks in her classroom. At the very beginning Madoka decided that the student number b_i (1 \le b_i \le n) will sit at the desk number i. Also there's an infinite line of students with numbers n + 1, n + 2, n + 3, \ldots waiting at the door with the hope of being able to learn something from the Madoka herself. Pay attention that each student has his unique number.After each lesson, the following happens in sequence.   The student sitting at the desk i moves to the desk p_i. All students move simultaneously.  If there is more than one student at a desk, the student with the lowest number keeps the place, and the others are removed from the class forever.  For all empty desks in ascending order, the student from the lowest number from the outside line occupies the desk. Note that in the end there is exactly one student at each desk again. It is guaranteed that the numbers p are such that at least one student is removed after each lesson. Check out the explanation to the first example for a better understanding.After several (possibly, zero) lessons the desk i is occupied by student a_i. Given the values a_1, a_2, \ldots, a_n and p_1, p_2, \ldots, p_n, find the lexicographically smallest suitable initial seating permutation b_1, b_2, \ldots, b_n.The permutation is an array of n different integers from 1 up to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not (2 occurs twice). [1,3,4] is not a permutation either (n=3 but there's 4 in the array).For two different permutations a and b of the same length, a is lexicographically less than b if in the first position where a and b differ, the permutation a has a smaller element than the corresponding element in b.
Data Center Maintenance                    

httpscodeforcescomproblemsetproblem949C

dfs and similar

1900

BigData Inc is a corporation that has n data centers indexed from 1 to n that are located all over the world These data centers provide storage for client data you can figure out that client data is really bigMain feature of services offered by BigData Inc is the access availability guarantee even under the circumstances of any data center having an outage Such a guarantee is ensured by using the twoway replication Twoway replication is such an approach for data storage that any piece of data is represented by two identical copies that are stored in two different data centersFor each of m company clients let us denote indices of two different data centers storing this client data as ci1 and ci2In order to keep data centers operational and safe the software running on data center computers is being updated regularly Release cycle of BigData Inc is one day meaning that the new version of software is being deployed to the data center computers each dayData center software update is a nontrivial long process that is why there is a special hourlong time frame that is dedicated for data center maintenance During the maintenance period data center computers are installing software updates and thus they may be unavailable Consider the day to be exactly h hours long For each data center there is an integer uj 0ujh1 defining the index of an hour of day such that during this hour data center j is unavailable due to maintenanceSumming up everything above the condition uci1uci2 should hold for each client or otherwise his data may be unaccessible while data centers that store it are under maintenanceDue to occasional timezone change in different cities all over the world the maintenance time in some of the data centers may change by one hour sometimes Company should be prepared for such situation that is why they decided to conduct an experiment choosing some nonempty subset of data centers and shifting the maintenance time for them by an hour later ie if ujh1 then the new maintenance hour would become 0 otherwise it would become uj1 Nonetheless such an experiment should not break the accessibility guarantees meaning that data of any client should be still available during any hour of a day after the data center maintenance times are changedSuch an experiment would provide useful insights but changing update time is quite an expensive procedure that is why the company asked you to find out the minimum number of data centers that have to be included in an experiment in order to keep the data accessibility guarantees
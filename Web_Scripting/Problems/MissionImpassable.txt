Mission Impassable                    

httpscodeforcescomproblemsetproblem150D

dp

2600

Market stalls now have the longawaited game The Colder Scrools V Nvodsk The game turned out to be difficult as hell and most students cant complete the last quest We dont go to Nvodsk That threatened winter exams The rector already started to wonder whether he should postpone the winter exams till April in fact he wanted to complete the quest himself But all of a sudden a stranger appeared at the door of his office Good afternoon My name is Chuck and I solve any problems  he saidAnd here they are sitting side by side but still they cant complete the mission The thing is to kill the final boss one should prove ones perfect skills in the art of managing letters One should be a real magician to do that And can you imagine what happens when magicians start competing But lets put it more formally you are given a string and a set of integers ai You are allowed to choose any substring that is a palindrome and delete it At that we receive some number of points equal to ak where k is the length of the deleted palindrome For some k ak1 which means that deleting palindrome strings of such length is forbidden After a substring is deleted the remaining part shifts together that is at no moment of time the string has gaps The process is repeated while the string has at least one palindrome substring that can be deleted All gained points are summed upDetermine what maximum number of points can be earnedOh  said Chuck raising from the chair  I used to love deleting palindromes just like you but one day I took an arrow in the Knee
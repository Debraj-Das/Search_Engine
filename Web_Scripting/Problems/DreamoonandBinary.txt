Dreamoon and Binary                    

httpscodeforcescomproblemsetproblem477D

dp

2700

Dreamoon saw a large integer x written on the ground and wants to print its binary form out Dreamoon has accomplished the part of turning x into its binary format Now he is going to print it in the following mannerHe has an integer n0 and can only perform the following two operations in any order for unlimited times each  Print n in binary form without leading zeros each print will append to the right of previous prints  Increase n by 1 Lets define an ideal sequence as a sequence of operations that can successfully print binary representation of x without leading zeros and ends with a print operation ie operation 1 Dreamoon wants to know how many different ideal sequences are there and the length in operations of the shortest ideal sequenceThe answers might be large so please print them modulo 1000000007 1097Lets define the string representation of an ideal sequence as a string of 1 and 2 where the ith character in the string matches the ith operation performed Two ideal sequences are called different if their string representations are different
Help Monks                    

httpscodeforcescomproblemsetproblem98D

constructive algorithms

2500

In a far away kingdom is the famous Lio Shan monastery Gods constructed three diamond pillars on the monasterys lawn long ago Gods also placed on one pillar n golden disks of different diameters in the order of the diameters decreasing from the bottom to the top Besides gods commanded to carry all the disks from the first pillar to the third one according to the following rules you can carry only one disk in one move you cannot put a larger disk on a smaller one There was no universal opinion concerning what is to happen after the gods will is done some people promised world peace and eternal happiness to everyone whereas others predicted that the kingdom will face communi gee what am I rambling about the Armageddon However as everybody knew that it was impossible to solve the problem in less than 2n1 moves and the lazy Lio Shan monks never even started to solve it everyone lives peacefully even though the problem was never solved and nobody was afraid of the ArmageddonHowever the monastery wasnt doing so well lately and the wise prior Ku Sean Sun had to cut some disks at the edges and use the gold for the greater good Wouldnt you think that the prior is entitled to have an air conditioning system Besides staying in the monastery all year is sooo dull One has to have a go at something new now and then go skiing for example Ku Sean Sun realize how big a mistake he had made only after a while after he cut the edges the diameters of some disks got the same that means that some moves that used to be impossible to make were at last possible why gods never prohibited to put a disk on a disk of the same diameter Thus the possible Armageddon can come earlier than was initially planned by gods Much earlier So much earlier in fact that Ku Sean Sun wont even have time to ski all he wants or relax under the air conditionerThe wise prior could never let that last thing happen and he asked one very old and very wise witch PikiWedia to help him May be she can determine the least number of moves needed to solve the gods problem However the witch laid out her cards and found no answer for the prior Then he asked you to help himCan you find the shortest solution of the problem given the number of disks and their diameters Keep in mind that it is allowed to place disks of the same diameter one on the other one however the order in which the disks are positioned on the third pillar in the end should match the initial order of the disks on the first pillar
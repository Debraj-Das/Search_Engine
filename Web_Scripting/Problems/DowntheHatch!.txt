Down the Hatch                    

httpscodeforcescomproblemsetproblem332A

implementation

1300

Everybody knows that the Berland citizens are keen on health especially students Berland students are so tough that all they drink is orange juiceYesterday one student Vasya and his mates made some barbecue and they drank this healthy drink only After they ran out of the first barrel of juice they decided to play a simple game All n people who came to the barbecue sat in a circle thus each person received a unique index bi from 0 to n1 The person number 0 started the game this time it was Vasya All turns in the game were numbered by integers starting from 1 If the jth turn was made by the person with index bi then this person acted like that  he pointed at the person with index bi1modn either with an elbow or with a nod xmody is the remainder after dividing x by y  if j4 and the players who had turns number j1 j2 j3 made during their turns the same moves as player bi on the current turn then he had drunk a glass of juice  the turn went to person number bi1modn The person who was pointed on the last turn did not make any actionsThe problem was Vasyas drunk too much juice and cant remember the goal of the game However Vasyas got the recorded sequence of all the participants actions including himself Now Vasya wants to find out the maximum amount of juice he could drink if he played optimally well the other players actions do not change Help himYou can assume that in any scenario there is enough juice for everybody
Moscow Gorillas                    

https://codeforces.com/problemset/problem/1793/D

binary search

1800

In winter, the inhabitants of the Moscow Zoo are very bored, in particular, it concerns gorillas. You decided to entertain them and brought a permutation p of length n to the zoo.A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 occurs twice in the array) and [1,3,4] is also not a permutation (n=3, but 4 is present in the array).The gorillas had their own permutation q of length n. They suggested that you count the number of pairs of integers l, r (1 \le l \le r \le n) such that \operatorname{MEX}([p_l, p_{l+1}, \ldots, p_r])=\operatorname{MEX}([q_l, q_{l+1}, \ldots, q_r]).The \operatorname{MEX} of the sequence is the minimum integer positive number missing from this sequence. For example, \operatorname{MEX}([1, 3]) = 2, \operatorname{MEX}([5]) = 1, \operatorname{MEX}([3, 1, 2, 6]) = 4.You do not want to risk your health, so you will not dare to refuse the gorillas.
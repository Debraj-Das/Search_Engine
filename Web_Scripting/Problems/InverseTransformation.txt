Inverse Transformation                    

https://codeforces.com/problemset/problem/1787/F

constructive algorithms

2500

A permutation scientist is studying a self-transforming permutation a consisting of n elements a_1,a_2,\ldots,a_n.A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. For example, [1], [4, 3, 5, 1, 2] are permutations, while [1, 1], [4, 3, 1] are not.The permutation transforms day by day. On each day, each element x becomes a_x, that is, a_x becomes a_{a_x}. Specifically:   on the first day, the permutation becomes b, where b_x = a_{a_x};  on the second day, the permutation becomes c, where c_x = b_{b_x};  \ldots  For example, consider permutation a = [2,3,1]. On the first day, it becomes [3,1,2]. On the second day, it becomes [2,3,1].You're given the permutation a' on the k-th day.Define \sigma(x) = a_x, and define f(x) as the minimal positive integer m such that \sigma^m(x) = x, where \sigma^m(x) denotes \underbrace{\sigma(\sigma(\ldots \sigma}_{m \text{ times}}(x) \ldots)).For example, if a = [2,3,1], then \sigma(1) = 2, \sigma^2(1) = \sigma(\sigma(1)) = \sigma(2) = 3, \sigma^3(1) = \sigma(\sigma(\sigma(1))) = \sigma(3) = 1, so f(1) = 3. And if a=[4,2,1,3], \sigma(2) = 2 so f(2) = 1; \sigma(3) = 1, \sigma^2(3) = 4, \sigma^3(3) = 3 so f(3) = 3.Find the initial permutation a such that \sum\limits^n_{i=1} \dfrac{1}{f(i)} is minimum possible.
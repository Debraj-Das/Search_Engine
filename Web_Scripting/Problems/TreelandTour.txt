Treeland Tour                    

httpscodeforcescomproblemsetproblem490F

data structures

2200

The Road Accident band is planning an unprecedented tour around Treeland The RA fans are looking forward to the event and making bets on how many concerts their favorite group will haveTreeland consists of n cities some pairs of cities are connected by bidirectional roads Overall the country has n1 roads We know that it is possible to get to any city from any other one The cities are numbered by integers from 1 to n For every city we know its value ri  the number of people in itWe know that the band will travel along some path having concerts in some cities along the path The bands path will not pass one city twice each time they move to the city that hasnt been previously visited Thus the musicians will travel along some path without visiting any city twice and in some not necessarily all cities along the way they will have concertsThe band plans to gather all the big stadiums and concert halls during the tour so every time they will perform in a city which population is larger than the population of the previously visited with concert city In other words the sequence of population in the cities where the concerts will be held is strictly increasingIn a recent interview with the leader of the road accident band promised to the fans that the band will give concert in the largest possible number of cities Thus the band will travel along some chain of cities of Treeland and have concerts in some of these cities so that the population number will increase and the number of concerts will be the largest possibleThe fans of Treeland are frantically trying to figure out how many concerts the group will have in Treeland Looks like they cant manage without some help from a real programmer Help the fans find the sought number of concerts
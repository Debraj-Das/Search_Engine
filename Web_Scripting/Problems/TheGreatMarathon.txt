The Great Marathon                    

httpscodeforcescomproblemsetproblem38H

dp

2400

On the Berland Dependence Day it was decided to organize a great marathon Berland consists of n cities some of which are linked by twoway roads Each road has a certain length The cities are numbered from 1 to n It is known that one can get from any city to any other one by the roadsn runners take part in the competition one from each city But Berland runners are talkative by nature and thats why the juries took measures to avoid large crowds of marathon participants The jury decided that every runner should start the marathon from their hometown Before the start every sportsman will get a piece of paper containing the name of the city where the sportsmans finishing line is The finish is chosen randomly for every sportsman but it cant coincide with the sportsmans starting point Several sportsmen are allowed to finish in one and the same city All the sportsmen start simultaneously and everyone runs the shortest route from the starting point to the finishing one All the sportsmen run at one speed which equals to 1After the competition a followup table of the results will be composed where the sportsmen will be sorted according to the nondecrease of time they spent to cover the distance The first g sportsmen in the table will get golden medals the next s sportsmen will get silver medals and the rest will get bronze medals Besides if two or more sportsmen spend the same amount of time to cover the distance they are sorted according to the number of the city where a sportsman started to run in the ascending order That means no two sportsmen share one and the same placeAccording to the rules of the competition the number of gold medals g must satisfy the inequation g1gg2 where g1 and g2 are values formed historically In a similar way the number of silver medals s must satisfy the inequation s1ss2 where s1 and s2 are also values formed historicallyAt present before the start of the competition the destination points of every sportsman are unknown However the press demands details and thats why you are given the task of counting the number of the ways to distribute the medals Two ways to distribute the medals are considered different if at least one sportsman could have received during those distributions different kinds of medals
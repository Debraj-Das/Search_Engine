Fools and Foolproof Roads                    

httpscodeforcescomproblemsetproblem362D

data structures

2100

You must have heard all about the Foolland on your Geography lessons Specifically you must know that federal structure of this country has been the same for many centuries The country consists of n cities some pairs of cities are connected by bidirectional roads each road is described by its length liThe fools lived in their land joyfully but a recent revolution changed the king Now the king is Vasily the Bear Vasily divided the country cities into regions so that any two cities of the same region have a path along the roads between them and any two cities of different regions dont have such path Then Vasily decided to upgrade the road network and construct exactly p new roads in the country Constructing a road goes like this  We choose a pair of distinct cities u v that will be connected by a new road at that it is possible that there already is a road between these cities  We define the length of the new road if cities u v belong to distinct regions then the length is calculated as min109S1 S  the total length of all roads that exist in the linked regions otherwise we assume that the length equals 1000  We build a road of the specified length between the chosen cities If the new road connects two distinct regions after construction of the road these regions are combined into one new region Vasily wants the road constructing process to result in the country that consists exactly of q regions Your task is to come up with such road constructing plan for Vasily that it meets the requirement and minimizes the total length of the built roads
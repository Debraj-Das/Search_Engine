Famil Door and Roads                    

httpscodeforcescomproblemsetproblem629E

combinatorics

2300

Famil Doors City map looks like a tree undirected connected acyclic graph so other people call it Treeland There are n intersections in the city connected by n1 bidirectional roadsThere are m friends of Famil Door living in the city The ith friend lives at the intersection ui and works at the intersection vi Everyone in the city is unhappy because there is exactly one simple path between their home and workFamil Door plans to construct exactly one new road and he will randomly choose one among nn12 possibilities Note that he may even build a new road between two cities that are already connected by oneHe knows that each of his friends will become happy if after Famil Door constructs a new road there is a path from this friend home to work and back that doesnt visit the same road twice Formally there is a simple cycle containing both ui and vi Moreover if the friend becomes happy his pleasure is equal to the length of such path its easy to see that its unique For each of his friends Famil Door wants to know his expected pleasure that is the expected length of the cycle containing both ui and vi if we consider only cases when such a cycle exists
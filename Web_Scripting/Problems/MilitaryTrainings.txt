Military Trainings                    

httpscodeforcescomproblemsetproblem207B2



1900

The Smart Beaver from ABBYY started cooperating with the Ministry of Defence Now they train soldiers to move armoured columns The training involves testing a new type of tanks that can transmit information To test the new type of tanks the training has a special exercise its essence is as followsInitially the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end During the whole exercise exactly n messages must be transferred from the beginning of the column to its endTransferring one message is as follows The tank that goes first in the column transmits the message to some tank in the column The tank which received the message sends it further down the column The process is continued until the last tank receives the message It is possible that not all tanks in the column will receive the message  it is important that the last tank in the column should receive the messageAfter the last tank tank number n receives the message it moves to the beginning of the column and sends another message to the end of the column in the same manner When the message reaches the last tank tank number n1 that tank moves to the beginning of the column and sends the next message to the end of the column and so on Thus the exercise is completed when the tanks in the column return to their original order that is immediately after tank number 1 moves to the beginning of the columnIf the tanks were initially placed in the column in the order 12n then after the first message their order changes to n1n1 after the second message it changes to n1n1n2 and so onThe tanks are constructed in a very peculiar way The tank with number i is characterized by one integer ai which is called the message receiving radius of this tankTransferring a message between two tanks takes one second however not always one tank can transmit a message to another one Lets consider two tanks in the column such that the first of them is the ith in the column counting from the beginning and the second one is the jth in the column and suppose the second tank has number x Then the first tank can transmit a message to the second tank if ij and ijaxThe Ministry of Defense and soon the Smart Beaver faced the question of how to organize the training efficiently The exercise should be finished as quickly as possible Well neglect the time that the tanks spend on moving along the column since improving the tanks speed is not a priority for this trainingYou are given the number of tanks as well as the message receiving radii of all tanks You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible
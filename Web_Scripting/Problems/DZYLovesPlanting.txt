DZY Loves Planting                    

httpscodeforcescomproblemsetproblem444E

binary search

2700

DZY loves planting and he enjoys solving tree problemsDZY has a weighted tree connected undirected graph without cycles containing n nodes they are numbered from 1 to n He defines the function gxy 1xyn as the longest edge in the shortest path between nodes x and y Specially gzz0 for every zFor every integer sequence p1p2pn 1pin DZY defines fp as  DZY wants to find such a sequence p that fp has maximum possible value But there is one more restriction the element j can appear in p at most xj timesPlease find the maximum possible fp under the described restrictions
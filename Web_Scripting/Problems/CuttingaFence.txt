Cutting a Fence                    

httpscodeforcescomproblemsetproblem212D

binary search

2500

Vasya the carpenter has an estate that is separated from the wood by a fence The fence consists of n planks put in a line The fence is not closed in a circle The planks are numbered from left to right from 1 to n the ith plank is of height ai All planks have the same width the lower edge of each plank is located at the ground levelRecently a local newspaper Malevich and Life wrote that the most fashionable way to decorate a fence in the summer is to draw a fuchsiacolored rectangle on it the lower side of the rectangle must be located at the lower edge of the fenceVasya is delighted with this idea He immediately bought some fuchsiacolored paint and began to decide what kind of the rectangle he should paint Vasya is sure that the rectangle should cover k consecutive planks In other words he will paint planks number x x1  xk1 for some x 1xnk1 He wants to paint the rectangle of maximal area so the rectangle height equals min ai for xixk1 x is the number of the first colored plankVasya has already made up his mind that the rectangle width can be equal to one of numbers of the sequence k1k2km For each ki he wants to know the expected height of the painted rectangle provided that he selects x for such fence uniformly among all nki1 possible values Help him to find the expected heights
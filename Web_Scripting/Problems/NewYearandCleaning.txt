New Year and Cleaning                    

httpscodeforcescomproblemsetproblem611F

binary search

2500

Limak is a little polar bear His parents told him to clean a house before the New Years Eve Their house is a rectangular grid with h rows and w columns Each cell is an empty squareHe is a little bear and thus he cant clean a house by himself Instead he is going to use a cleaning robotA cleaning robot has a builtin pattern of n moves defined by a string of the length n A single move character moves a robot to one of four adjacent cells Each character is one of the following four U up D down L left R right One move takes one minuteA cleaning robot must be placed and started in some cell Then it repeats its pattern of moves till it hits a wall one of four borders of a house After hitting a wall it can be placed and used againLimak isnt sure if placing a cleaning robot in one cell will be enough Thus he is going to start it wh times one time in each cell Maybe some cells will be cleaned more than once but who caresLimak asks you one question How much time will it take to clean a house Find and print the number of minutes modulo 1097 Its also possible that a cleaning robot will never stop then print 1 without the quotes insteadPlacing and starting a robot takes no time however you must count a move when robot hits a wall Take a look into samples for further clarification
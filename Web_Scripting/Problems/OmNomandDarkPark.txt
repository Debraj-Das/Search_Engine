Om Nom and Dark Park                    

httpscodeforcescomproblemsetproblem526B

dfs and similar

1400

Om Nom is the main character of a game Cut the Rope He is a bright little monster who likes visiting friends living at the other side of the park However the dark old parks can scare even somebody as fearless as Om Nom so he asks you to help him  The park consists of 2n11 squares connected by roads so that the scheme of the park is a full binary tree of depth n More formally the entrance to the park is located at the square 1 The exits out of the park are located at squares 2n2n12n11 and these exits lead straight to the Om Nom friends houses From each square i 2i2n1 there is a road to the square  Thus it is possible to go from the park entrance to each of the exits by walking along exactly n roads    To light the path roads in the evening the park keeper installed street lights along each road The road that leads from square i to square  has ai lightsOm Nom loves counting lights on the way to his friend Om Nom is afraid of spiders who live in the park so he doesnt like to walk along roads that are not enough lit What he wants is that the way to any of his friends should have in total the same number of lights That will make him feel safe He asked you to help him install additional lights Determine what minimum number of lights it is needed to additionally place on the park roads so that a path from the entrance to any exit of the park contains the same number of street lights You may add an arbitrary number of street lights to each of the roads
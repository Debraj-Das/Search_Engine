Case of a Top Secret                    

httpscodeforcescomproblemsetproblem555D

binary search

2500

Andrewid the Android is a galaxyfamous detective Now he is busy with a top secret case the details of which are not subject to disclosureHowever he needs help conducting one of the investigative experiment There are n pegs put on a plane they are numbered from 1 to n the coordinates of the ith of them are xi0 Then we tie to the bottom of one of the pegs a weight on a tight rope of length l thus its coordinates will be equal to xil where i is the number of the used peg Then the weight is pushed to the right so that it starts to rotate counterclockwise At the same time if the weight during rotation touches some of the other pegs it then begins to rotate around that peg Suppose that each peg itself is very thin and does not affect the rope length while weight is rotating around it  More formally if at some moment the segment of the rope contains one or more pegs in addition to the peg around which the weight is rotating the weight will then rotate around the farthermost one of them on a shorter segment of a rope In particular if the segment of the rope touches some peg by its endpoint it is considered that the weight starts to rotate around that peg on a segment of the rope of length 0At some moment the weight will begin to rotate around some peg without affecting the rest of the pegs Andrewid interested in determining the number of this pegAndrewid prepared m queries containing initial conditions for pushing the weight help him to determine for each of them around what peg the weight will eventually rotate
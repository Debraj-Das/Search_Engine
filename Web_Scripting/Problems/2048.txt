2048                    

httpscodeforcescomproblemsetproblem413D

bitmasks

2000

The programmers from the R2 company love playing 2048 One day they decided to invent their own simplified version of this game  2k on a stripeImagine an infinite in one direction stripe consisting of unit squares the side of each square is equal to the height of the stripe Each square can either be empty or contain some numberInitially all squares are empty Then at infinity one of the unit squares number 2 or 4 appears Then the player presses a button once and the appeared number begins to move towards the beginning of the stripe Lets assume that some number x moves to the beginning of the stripe then it will stop if  it either gets in the first square of the stripe  or it is in the square that is preceded by a square with number y yx But if number x at some point of time gets to the square with the same number then both numbers add to each other and result in 2x The new number 2x continues moving to the beginning of the stripe by the same rules After the final stop of the number moving process the infinity gets a new number 2 or 4 and the process repeats Read the notes to the test samples to better understand the moving strategyI guess youve understood that the game progress fully depends on the order in which numbers 2 and 4 appear Lets look at some sequence of numbers 2 and 4 in the game We assume that the sequence is winning if it results in at least one square getting the number greater or equal than 2k The goal of the game is to make up a winning sequence of n numbers But not everything is so simple some numbers in the sequence are identified beforehand You are given a sequence consisting of numbers 0 2 4 Count how many ways there are to replace each 0 of the sequence with 2 or 4 to get a winning sequence
Marek and Matching (hard version)                    

https://codeforces.com/problemset/problem/1210/F2

brute force

3200

This is a harder version of the problem. In this version, n \le 7.Marek is working hard on creating strong test cases to his new algorithmic problem. Do you want to know what it is? Nah, we're not telling you. However, we can tell you how he generates test cases.Marek chooses an integer n and n^2 integers p_{ij} (1 \le i \le n, 1 \le j \le n). He then generates a random bipartite graph with 2n vertices. There are n vertices on the left side: \ell_1, \ell_2, \dots, \ell_n, and n vertices on the right side: r_1, r_2, \dots, r_n. For each i and j, he puts an edge between vertices \ell_i and r_j with probability p_{ij} percent.It turns out that the tests will be strong only if a perfect matching exists in the generated graph. What is the probability that this will occur?It can be shown that this value can be represented as \frac{P}{Q} where P and Q are coprime integers and Q \not\equiv 0 \pmod{10^9+7}. Let Q^{-1} be an integer for which Q \cdot Q^{-1} \equiv 1 \pmod{10^9+7}. Print the value of P \cdot Q^{-1} modulo 10^9+7.
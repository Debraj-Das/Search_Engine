Students Camp                    

httpscodeforcescomproblemsetproblem708E

dp

3100

Alex studied well and won the trip to student camp Alushta located on the seashore Unfortunately its the period of the strong winds now and there is a chance the camp will be destroyed Camp building can be represented as the rectangle of n2 concrete blocks height and m blocks widthEvery day there is a breeze blowing from the sea Each block except for the blocks of the upper and lower levers such that there is no block to the left of it is destroyed with the probability  Similarly each night the breeze blows in the direction to the sea Thus each block again except for the blocks of the upper and lower levers such that there is no block to the right of it is destroyed with the same probability p Note that blocks of the upper and lower level are indestructible so there are only nm blocks that can be destroyedThe period of the strong winds will last for k days and k nights If during this period the building will split in at least two connected components it will collapse and Alex will have to find another place to spend summerFind the probability that Alex wont have to look for other opportunities and will be able to spend the summer in this camp
Organizing a Music Festival                    

https://codeforces.com/problemset/problem/1552/I

dfs and similar

3400

You are the organizer of the famous "Zurich Music Festival". There will be n singers who will perform at the festival, identified by the integers 1, 2, \dots, n. You must choose in which order they are going to perform on stage. You have m friends and each of them has a set of favourite singers. More precisely, for each 1\le i\le m, the i-th friend likes singers s_{i,1}, \, s_{i, 2}, \, \dots, \,s_{i, q_i}.A friend of yours is happy if the singers he likes perform consecutively (in an arbitrary order). An ordering of the singers is valid if it makes all your friends happy.Compute the number of valid orderings modulo 998\,244\,353.
Dungeons and Candies                    

httpscodeforcescomproblemsetproblem436C

dsu

1800

During the loading of the game Dungeons and Candies you are required to get descriptions of k levels from the server Each description is a map of an nm checkered rectangular field Some cells of the field contain candies each cell has at most one candy An empty cell is denoted as  on the map but if a cell has a candy it is denoted as a letter of the English alphabet A level may contain identical candies in this case the letters in the corresponding cells of the map will be the same  When you transmit information via a network you want to minimize traffic  the total size of the transferred data The levels can be transmitted in any order There are two ways to transmit the current level A  You can transmit the whole level A Then you need to transmit nm bytes via the network  You can transmit the difference between level A and some previously transmitted level B if it exists this operation requires to transmit dABw bytes where dAB is the number of cells of the field that are different for A and B and w is a constant Note that you should compare only the corresponding cells of levels A and B to calculate dAB You cannot transform the maps of levels ie rotate or shift them relatively to each other Your task is to find a way to transfer all the k levels and minimize the traffic
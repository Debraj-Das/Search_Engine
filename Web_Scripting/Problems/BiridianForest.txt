Biridian Forest                    

httpscodeforcescomproblemsetproblem329B

dfs and similar

1500

Youre a mikemon breeder currently in the middle of your journey to become a mikemon master Your current obstacle is go through the infamous Biridian ForestThe forestThe Biridian Forest is a twodimensional grid consisting of r rows and c columns Each cell in Biridian Forest may contain a tree or may be vacant A vacant cell may be occupied by zero or more mikemon breeders there may also be breeders other than you in the forest Mikemon breeders including you cannot enter cells with trees One of the cells is designated as the exit cellThe initial grid including your initial position the exit cell and the initial positions of all other breeders will be given to you Heres an example of such grid from the first example  MovesBreeders including you may move in the forest In a single move breeders may perform one of the following actions   Do nothing  Move from the current cell to one of the four adjacent cells two cells are adjacent if they share a side Note that breeders cannot enter cells with trees  If you are located on the exit cell you may leave the forest Only you can perform this move  all other mikemon breeders will never leave the forest by using this type of movement After each time you make a single move each of the other breeders simultaneously make a single move the choice of which move to make may be different for each of the breedersMikemon battleIf you and t t0 mikemon breeders are located on the same cell exactly t mikemon battles will ensue that time since you will be battling each of those t breeders once After the battle all of those t breeders will leave the forest to heal their respective mikemonsNote that the moment you leave the forest no more mikemon battles can ensue even if another mikemon breeder move to the exit cell immediately after that Also note that a battle only happens between you and another breeders  there will be no battle between two other breeders there may be multiple breeders coexisting in a single cellYour goalYou would like to leave the forest In order to do so you have to make a sequence of moves ending with a move of the final type Before you make any move however you post this sequence on your personal virtual idol Blog Then you will follow this sequence of moves faithfullyGoal of other breedersBecause you post the sequence in your Blog the other breeders will all know your exact sequence of moves even before you make your first move All of them will move in such way that will guarantee a mikemon battle with you if possible The breeders that couldnt battle you will do nothingYour taskPrint the minimum number of mikemon battles that you must participate in assuming that you pick the sequence of moves that minimize this number Note that you are not required to minimize the number of moves you make
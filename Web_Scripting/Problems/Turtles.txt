Turtles                    

httpscodeforcescomproblemsetproblem348D

dp

2500

Youve got a table of size nm Well consider the table rows numbered from top to bottom 1 through n and the columns numbered from left to right 1 through m Then well denote the cell in row x and column y as xyInitially cell 11 contains two similar turtles Both turtles want to get to cell nm Some cells of the table have obstacles but it is guaranteed that there arent any obstacles in the upper left and lower right corner A turtle one or the other can go from cell xy to one of two cells x1y and xy1 as long as the required cell doesnt contain an obstacle The turtles have had an argument so they dont want to have any chance of meeting each other along the way Help them find the number of ways in which they can go from cell 11 to cell nmMore formally find the number of pairs of nonintersecting ways from cell 11 to cell nm modulo 1000000007 1097 Two ways are called nonintersecting if they have exactly two common points  the starting point and the final point